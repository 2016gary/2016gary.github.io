<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Cloudera Data Analyst Training-Pig 翻译</title>
    <!-- Styles -->
    
    <style type="text/css" media="print">
      * {
    margin: 0;
    padding: 0;
}

@page {
    size: landscape;
}

body {
    font: 100% "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
    padding: 0;
    margin: 0;
}

div.slide {
    min-width: 800px;
    min-height: 600px;
    padding: 1em;
    overflow: hidden;
    page-break-after: always;
    border: 1px solid black;
    border-radius: 20px;
}

div.slide div.inner {
    width: 800px;
    height: 600px;
    margin: auto;
}

h1 {
    font-size: 2.4em;
}

h2 {
    font-size: 1.4em;
}

h3 {
    margin: 1em 0;
}

ul {
    margin: 0;
    padding: 0;
}

p, li, pre {
    margin: 1em 0;
}

li {
    margin-left: 2em;
}

a {
    color: #000000;
}

pre, code {
    max-width: 800px;
    background: #eee;
    font-family: Monaco, monospace;
    font-size: 90%;
}

pre {
    padding: .2em .5em;
    overflow: hidden;
    border-radius: .8em;
}

code {
    padding: 0 .2em;
}

.slide header:only-child h1 {
  line-height: 180%;
  text-align: center;
  display: table-cell;
  vertical-align: middle;
  height: 600px;
  width: 800px;
  font-size: 48px;
  margin-top:100px;
  margin-bottom:100px;
}

#toc, #help, .slide aside, .slide footer, .slide .notes,
.presenter_notes, #current_presenter_notes, #presenter_note {
  display: none;
}

    </style>
    <style type="text/css" media="screen, projection">
      body {
  font: 14px "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
  background: #778;
  padding: 0;
  margin: 0;
  overflow: hidden;
}

div.presentation {
  position: absolute;
  width: 100%;
  display: table-cell;
  vertical-align: middle;
  height: 100%;
  background: inherit;
}

div.presentation > h1 {
  display: none;
}

div.slides, body.expose div.slides.nocontext {
  width: 100%;
  height: 100%;
  left: 0;
  top: 0;
  position: absolute;
  display: block;
}

div.slides.nocontext {
  width: 900px;
  margin: 0 auto;
  overflow: hidden;
  position: relative;
  left: auto;
  top: auto;
}

div.slide {
  display: inline;
  position: absolute;
  overflow: hidden;
  width: 900px;
  height: 700px;
  margin-top: -350px;
  margin-left: -400px;
  left: 50%;
  top: 50%;
  background: -webkit-gradient(linear, left bottom, left top, from(#bbd), to(#fff));
  background-color: #eee;
  background: -moz-linear-gradient(bottom, #bbd, #fff);
  -webkit-transition: margin 0.25s ease-in-out;
  -moz-transition: margin 0.25s ease-in-out;
  -o-transition: margin 0.25s ease-in-out;
  border-top-left-radius: 20px;
  -moz-border-radius-topleft: 20px;
  -webkit-border-top-left-radius: 20px;
  border-top-right-radius: 20px;
  -moz-border-radius-topright: 20px;
  -webkit-border-top-right-radius: 20px;
  border-bottom-right-radius: 20px;
  -moz-border-radius-bottomright: 20px;
  -webkit-border-bottom-right-radius: 20px;
  border-bottom-left-radius: 20px;
  -moz-border-radius-bottomleft: 20px;
  -webkit-border-bottom-left-radius: 20px;
}

/* Expose */

body.expose div.slides {
  float: left;
  position: relative;
  overflow: auto;
  margin-bottom: 10px;
}

body.expose div.slide {
  display: block;
  float: left;
  position: relative;
  left: auto !important;
  top: auto !important;
  margin: 10px !important;
  -webkit-transition: none;
  -moz-transition: none;
  -o-transition: none;
  -moz-transform: scale(.33, .33);
  -moz-transform-origin: 0 0;
  -webkit-transform: scale(.33, .33);
  -webkit-transform-origin: 0 0;
  -o-transform: scale(.33, .33);
  -o-transform-origin: 0 0;
  -webkit-transition: none;
  -moz-transition: none;
  -o-transition: none;
  cursor: pointer;
}

body.expose div.slide:hover {
  background: -webkit-gradient(linear, left bottom, left top, from(#bdd), to(#fff));
  background-color: #eee;
  background: -moz-linear-gradient(bottom, #bdd, #fff);
}

body.expose .slide-wrapper {
  float: left;
  position: relative;
  margin: .5%;
  width: 300px;
  height: 233px;
}

body.expose .slide footer {
}

body.expose .slide .inner {
}

body.expose .slide.far-past,
body.expose .slide.past,
body.expose .slide.future,
body.expose .slide.far-future {
  margin-left: 0;
}

body.expose .slide.current {
  background: -webkit-gradient(linear, left bottom, left top, from(#ddb), to(#fff));
  background-color: #eee;
  background: -moz-linear-gradient(bottom, #ddb, #fff);
  border: 16px solid #fff;
  -moz-transform: scale(.315, .315);
  -moz-transform-origin: 0 0;
  -webkit-transform: scale(.315, .315);
  -webkit-transform-origin: 0 0;
  -o-transform: scale(.315, .315);
  -o-transform-origin: 0 0;
}

/* Presenter Mode */

body.presenter_view div.slide {
  display: inline;
  position: absolute;
  overflow: hidden;
  -moz-transform: scale(.5, .5);
  -moz-transform-origin: 0 0;
  -webkit-transform: scale(.5, .5);
  -webkit-transform-origin: 0 0;
  -o-transform: scale(.5, .5);
  -o-transform-origin: 0 0;
    margin-top: -300px;
}

body.presenter_view .slide.far-past {
  display: block;
  margin-left: -1500px;
}

body.presenter_view .slide.past {
  display: block;
  margin-left: -975px;
}

body.presenter_view .slide.current {
  display: block;
  margin-left: -475px;
  border: 8px solid maroon;
  z-index: 2;
}

body.presenter_view .slide.future {
  display: block;
  margin-left: 25px;
  z-index: 1;
}

body.presenter_view .slide.far-future {
  display: block;
  margin-left: 525px;
}

body.presenter_view div#current_presenter_notes {
    visibility: visible;
    display: block;
    position: absolute;
    overflow: auto;
    vertical-align: middle;
    left: 50%;
    top: 50%;
    margin-left: -475px;
    margin-top: 100px;
    z-index: 2;
    width: 950px;
    border-style: solid;
    height: 30%;
    background-color: silver;
}

body.presenter_view div#current_presenter_notes section {
  font-family: "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
  color: black;
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  display: block;
  overflow: visible;
    position: relative;
    background-color: #fffeff;
    height: 120px;
    margin-right: 30px;
    margin-top: 60px;
    margin-left: 30px;
    padding-right: 10px;
    padding-left: 10px;
    padding-top: 10px;
}

body.presenter_view div#current_presenter_notes section p {
    margin: 0;
}

body.presenter_view div#current_presenter_notes h1 {
    font-size: 50%;
    display: block;
}

div#current_presenter_notes {
  display: none;
}

div.slide div.presenter_notes, div.slides div.presenter_notes {
  display: none;
}

/* Slide styles */

div.slide p {
  font-size: 20px;
}

.slide.far-past {
  display: block;
  margin-left: -2400px;
}

.slide.past {
  display: block;
  margin-left: -1400px;
}

.slide.current {
  display: block;
  margin-left: -450px;
}

.slide.future {
  display: block;
  margin-left: 500px;
}

.slide.far-future {
  display: block;
  margin-left: 1500px;
}

body.three-d div.slides {
  -webkit-transform: translateX(50px) scale(0.8) rotateY(10deg);
  -moz-transform: translateX(50px) scale(0.8) rotateY(10deg);
  -o-transform: translateX(50px) scale(0.8) rotateY(10deg);
}


/* Content */

header:not(:only-child) {
  font-family: "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
  font-weight: normal;
  font-size: 50px;
  letter-spacing: -.05em;
  color: black;
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  position: absolute;
  left: 30px;
  top: 25px;
  margin: 0;
  padding: 0;
}

header h1, header h2, header h3, header h4, header h5, header h6 {
  display: inline;
  font-size: 100%;
  font-weight: normal;
  padding: 0;
  margin: 0;
}

header h2:first-child {
  margin-top: 0;
}

section, .slide header:only-child h1 {
  font-family: "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
  color: #3f3f3f;
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  margin-left: 30px;
  margin-right: 30px;
  margin-top: 100px;
  display: block;
  overflow: hidden;
}

img { display: block; margin: auto; }

section img.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

section img.align-right {
  display: block;
  margin-left: auto;
  margin-right: 0;
}

section img.align-left {
  display: block;
  margin-right: auto;
  margin-left: 0;
}

a {
  color: inherit;
  display: inline-block;
  text-decoration: none;
  line-height: 110%;
  border-bottom: 2px solid #3f3f3f;
}

pre, code, tt {
  font-family: Monaco, Consolas, 'Bitstream Vera Sans Mono', 'Lucida Console', FreeMono, Courier, monospace;
}

pre, .gist .gist-file .gist-data {
  font-size: 18px;
  max-height: 485px;
  padding-top: 0.25em !important;
  padding-right: 0.5em !important;
  padding-left: 0.5em !important;
  overflow: auto;
}

/* render a nice scrollbar in overflowed pre area's */
::-webkit-scrollbar {
  height: 8px;
  width: 8px;
}
::-webkit-scrollbar-thumb {
  background: -webkit-gradient(linear, left bottom, left top, from(#777), to(#bbd));
  -webkit-border-radius: 1ex;
}
::-webkit-scrollbar-corner {
  background: #dedede;
}

blockquote {
  border-left: solid 8px #778;
  padding: .1ex 1ex;
  font-style: italic;
  font-size: 20px;
}

li {
  padding: 10px 0;
  font-size: 20px;
}

li pre { margin-left: 0em; }

.slide header:only-child h1 {
  line-height: 180%;
  text-align: center;
  display: table-cell;
  vertical-align: middle;
  height: 700px;
  width: 900px;
  font-size: 50px;
  margin-top:100px;
  margin-bottom:100px;
}

.sidebar {
  clear: both;
  background: -webkit-gradient(linear, top right, bottom right, from(#dde), to(#fff));
  -webkit-transition: margin 0.25s ease-in-out;
  background-color: #eee;
  background: -moz-linear-gradient(right, #dde, #fff);
  border-right: 5px solid #ccd;
  z-index: 9999999;
  height: 100%;
  overflow: hidden;
  top: 0;
  position: absolute;
  display: block;
  margin: 0;
  margin-left: -400px;
  padding: 10px 16px;
  overflow: auto;
  -webkit-transition: margin 0.2s ease-in-out;
  -moz-transition: margin 0.2s ease-in-out;
  -o-transition: margin 0.2s ease-in-out;
}

.sidebar h2 {
  text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
  margin: 0 0 16px;
  padding: 0;
}

.sidebar table {
  width: 100%;
  margin: 0;
  padding: 0;
  border-collapse: collapse;
}

.sidebar table caption {
  display: none;
}

.sidebar tr {
  margin: 2px 0;
  border-bottom: 1px solid #ccc;
}

.sidebar th {
  text-align: left;
  font-weight: normal;
  max-width: 300px;
  overflow: hidden;
}

.sidebar tr.sub th {
  text-indent: 20px;
}

.sidebar td {
  text-align: right;
  min-width: 20px;
}

.sidebar a {
  display: block;
  text-decoration: none;
  border-bottom: none;
  padding: 4px 0;
}

.sidebar tr.active {
  background: #ff0;
}

aside {
  display: none;
}
  aside.source {
    position: absolute;
    bottom: 6px;
    left: 10px;
    text-indent: 10px;
  }
  aside.page_number {
    position: absolute;
    bottom: 6px;
    right: 10px;
    text-indent: 10px;
  }

.notes {
  display: none;
  padding: 10px;
  background: #ccc;
  border-radius: 10px;
  -moz-border-radius: 10px;
  -webkit-border-radius: 10px;
}
  div.slide p.notes {
    font-size: 90%;
}

/* Pygments default theme */
.hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } /* Comment */
.err { border: 1px solid #FF0000 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666666 } /* Operator */
.cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cp { color: #BC7A00 } /* Comment.Preproc */
.c1 { color: #408080; font-style: italic } /* Comment.Single */
.cs { color: #408080; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.gr { color: #FF0000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #00A000 } /* Generic.Inserted */
.go { color: #808080 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #0040D0 } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #7D9029 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #0000FF; font-weight: bold } /* Name.Class */
.no { color: #880000 } /* Name.Constant */
.nd { color: #AA22FF } /* Name.Decorator */
.ni { color: #999999; font-weight: bold } /* Name.Entity */
.ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.nf { color: #0000FF } /* Name.Function */
.nl { color: #A0A000 } /* Name.Label */
.nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.w { color: #bbbbbb } /* Text.Whitespace */
.mf { color: #666666 } /* Literal.Number.Float */
.mh { color: #666666 } /* Literal.Number.Hex */
.mi { color: #666666 } /* Literal.Number.Integer */
.mo { color: #666666 } /* Literal.Number.Oct */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #BB6688 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.il { color: #666666 } /* Literal.Number.Integer.Long */
.lineno { padding-right: 10px } /* A few space after linenos */

#blank {
  position: absolute;
  top: 0;
  left: 0;
  background-color: black;
  width: 100%;
  height: 100%;
  z-index: 64;
  display: none;
}

.image-reference {
  display: inline;
}

    </style>
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script>
      function main() {
    // Since we don't have the fallback of attachEvent and
    // other IE only stuff we won't try to run JS for IE.
    // It will run though when using Google Chrome Frame
    if (document.all) { return; }

    var currentSlideNo;
    var notesOn = false;
    var expanded = false;
    var hiddenContext = false;
    var blanked = false;
    var slides = document.getElementsByClassName('slide');
    var touchStartX = 0;
    var spaces = /\s+/, a1 = [''];
    var tocOpened = false;
    var helpOpened = false;
    var overviewActive = false;
    var modifierKeyDown = false;
    var scale = 1;
    var showingPresenterView = false;
    var presenterViewWin = null;
    var isPresenterView = false;

    var str2array = function(s) {
        if (typeof s == 'string' || s instanceof String) {
            if (s.indexOf(' ') < 0) {
                a1[0] = s;
                return a1;
            } else {
                return s.split(spaces);
            }
        }
        return s;
    };

    var trim = function(str) {
        return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
    };

    var addClass = function(node, classStr) {
        classStr = str2array(classStr);
        var cls = ' ' + node.className + ' ';
        for (var i = 0, len = classStr.length, c; i < len; ++i) {
            c = classStr[i];
            if (c && cls.indexOf(' ' + c + ' ') < 0) {
                cls += c + ' ';
            }
        }
        node.className = trim(cls);
    };

    var removeClass = function(node, classStr) {
        var cls;
        if (!node) {
            throw 'no node provided';
        }
        if (classStr !== undefined) {
            classStr = str2array(classStr);
            cls = ' ' + node.className + ' ';
            for (var i = 0, len = classStr.length; i < len; ++i) {
                cls = cls.replace(' ' + classStr[i] + ' ', ' ');
            }
            cls = trim(cls);
        } else {
            cls = '';
        }
        if (node.className != cls) {
            node.className = cls;
        }
    };

    var getSlideEl = function(slideNo) {
        if (slideNo > 0) {
            return slides[slideNo - 1];
        } else {
            return null;
        }
    };

    var getSlideTitle = function(slideNo) {
        var el = getSlideEl(slideNo);
        if (el) {
            var headers = el.getElementsByTagName('header');
            if (headers.length > 0) {
                return el.getElementsByTagName('header')[0].innerText;
            }
        }
        return null;
    };

    var getSlidePresenterNote = function(slideNo) {
        var el = getSlideEl(slideNo);
        if (el) {
            var n = el.getElementsByClassName('presenter_notes');
            if (n.length > 0) {
                return n[0];
            }
        }
        return null;
    };

    var changeSlideElClass = function(slideNo, className) {
        var el = getSlideEl(slideNo);
        if (el) {
            removeClass(el, 'far-past past current future far-future');
            addClass(el, className);
        }
    };

    var updateSlideClasses = function(updateOther) {
        window.location.hash = (isPresenterView ? "presenter" : "slide") + currentSlideNo;

        for (var i=1; i<currentSlideNo-1; i++) {
            changeSlideElClass(i, 'far-past');
        }

        changeSlideElClass(currentSlideNo - 1, 'past');
        changeSlideElClass(currentSlideNo, 'current');
        changeSlideElClass(currentSlideNo + 1, 'future');

        for (i=currentSlideNo+2; i<slides.length+1; i++) {
            changeSlideElClass(i, 'far-future');
        }

        highlightCurrentTocLink();

        processContext();

        document.getElementsByTagName('title')[0].innerText = getSlideTitle(currentSlideNo);

        updatePresenterNotes();

        if (updateOther) { updateOtherPage(); }
    };

    var updatePresenterNotes = function() {
        if (!isPresenterView) { return; }

        var existingNote = document.getElementById('current_presenter_notes');
        var currentNote = getSlidePresenterNote(currentSlideNo).cloneNode(true);
        currentNote.setAttribute('id', 'presenter_note');

        existingNote.replaceChild(currentNote, document.getElementById('presenter_note'));
    };

    var highlightCurrentTocLink = function() {
        var toc = document.getElementById('toc');

        if (toc) {
            var tocRows = toc.getElementsByTagName('tr');
            for (var i=0; i<tocRows.length; i++) {
                removeClass(tocRows.item(i), 'active');
            }

            var currentTocRow = document.getElementById('toc-row-' + currentSlideNo);
            if (currentTocRow) {
                addClass(currentTocRow, 'active');
            }
        }
    };

    var updateOtherPage = function() {
        if (!showingPresenterView) { return; }

        var w = isPresenterView ? window.opener : presenterViewWin;
        w.postMessage('slide#' + currentSlideNo, '*');
    };

    var nextSlide = function() {
        if (currentSlideNo < slides.length) {
            currentSlideNo++;
        }
        updateSlideClasses(true);
    };

    var prevSlide = function() {
        if (currentSlideNo > 1) {
            currentSlideNo--;
        }
        updateSlideClasses(true);
    };

    var showNotes = function() {
        var notes = getSlideEl(currentSlideNo).getElementsByClassName('notes');
        for (var i = 0, len = notes.length; i < len; i++) {
            notes.item(i).style.display = (notesOn) ? 'none':'block';
        }
        notesOn = !notesOn;
    };

    var showSlideNumbers = function() {
        var asides = document.getElementsByClassName('page_number');
        var hidden = asides[0].style.display != 'block';
        for (var i = 0; i < asides.length; i++) {
            asides.item(i).style.display = hidden ? 'block' : 'none';
        }
    };

    var showSlideSources = function() {
        var asides = document.getElementsByClassName('source');
        var hidden = asides[0].style.display != 'block';
        for (var i = 0; i < asides.length; i++) {
            asides.item(i).style.display = hidden ? 'block' : 'none';
        }
    };

    var showToc = function() {
        if (helpOpened) {
                showHelp();
        }
        var toc = document.getElementById('toc');
        if (toc) {
            toc.style.marginLeft = tocOpened ? '-' + (toc.clientWidth + 20) + 'px' : '0px';
            tocOpened = !tocOpened;
        }
        updateOverview();
    };

    var showHelp = function() {
        if (tocOpened) {
                showToc();
        }

        var help = document.getElementById('help');

        if (help) {
            help.style.marginLeft = helpOpened ? '-' + (help.clientWidth + 20) + 'px' : '0px';
            helpOpened = !helpOpened;
        }
    };

    var showPresenterView = function() {
        if (isPresenterView) { return; }

        if (showingPresenterView) {
            presenterViewWin.close();
            presenterViewWin = null;
            showingPresenterView = false;
        } else {
            presenterViewWin = open(window.location.pathname + "#presenter" + currentSlideNo, 'presenter_notes',
                                                                    'directories=no,location=no,toolbar=no,menubar=no,copyhistory=no');
            showingPresenterView = true;
        }
    };

    var switch3D = function() {
        if (document.body.className.indexOf('three-d') == -1) {
            document.getElementsByClassName('presentation')[0].style.webkitPerspective = '1000px';
            document.body.className += ' three-d';
        } else {
            window.setTimeout('document.getElementsByClassName(\'presentation\')[0].style.webkitPerspective = \'0\';', 2000);
            document.body.className = document.body.className.replace(/three-d/, '');
        }
    };

    var toggleOverview = function() {
        if (!overviewActive) {
            addClass(document.body, 'expose');
            overviewActive = true;
            setScale(1);
        } else {
            removeClass(document.body, 'expose');
            overviewActive = false;
            if (expanded) {
                setScale(scale);    // restore scale
            }
        }
        processContext();
        updateOverview();
    };

    var updateOverview = function() {
        try {
            var presentation = document.getElementsByClassName('presentation')[0];
        } catch (e) {
            return;
        }

        if (isPresenterView) {
            var action = overviewActive ? removeClass : addClass;
            action(document.body, 'presenter_view');
        }

        var toc = document.getElementById('toc');

        if (!toc) {
            return;
        }

        if (!tocOpened || !overviewActive) {
            presentation.style.marginLeft = '0px';
            presentation.style.width = '100%';
        } else {
            presentation.style.marginLeft = toc.clientWidth + 'px';
            presentation.style.width = (presentation.clientWidth - toc.clientWidth) + 'px';
        }
    };

    var computeScale = function() {
        var cSlide = document.getElementsByClassName('current')[0];
        var sx = cSlide.clientWidth / window.innerWidth;
        var sy = cSlide.clientHeight / window.innerHeight;
        return 1 / Math.max(sx, sy);
    };

    var setScale = function(scale) {
        var presentation = document.getElementsByClassName('slides')[0];
        var transform = 'scale(' + scale + ')';
        presentation.style.MozTransform = transform;
        presentation.style.WebkitTransform = transform;
        presentation.style.OTransform = transform;
        presentation.style.msTransform = transform;
        presentation.style.transform = transform;
    };

    var expandSlides = function() {
        if (overviewActive) {
            return;
        }
        if (expanded) {
            setScale(1);
            expanded = false;
        } else {
            scale = computeScale();
            setScale(scale);
            expanded = true;
        }
    };

    var showContext = function() {
        try {
            var presentation = document.getElementsByClassName('slides')[0];
            removeClass(presentation, 'nocontext');
        } catch (e) {}
    };

    var hideContext = function() {
        try {
            var presentation = document.getElementsByClassName('slides')[0];
            addClass(presentation, 'nocontext');
        } catch (e) {}
    };

    var processContext = function() {
        if (hiddenContext) {
            hideContext();
        } else {
            showContext();
        }
    };

    var toggleContext = function() {
        hiddenContext = !hiddenContext;
        processContext();
    };

    var toggleBlank = function() {
        blank_elem = document.getElementById('blank');

        blank_elem.style.display = blanked ? 'none' : 'block';

        blanked = !blanked;
    };

    var isModifierKey = function(keyCode) {
        switch (keyCode) {
            case 16: // shift
            case 17: // ctrl
            case 18: // alt
            case 91: // command
                return true;
                break;
            default:
                return false;
                break;
        }
    };

    var checkModifierKeyUp = function(event) {
        if (isModifierKey(event.keyCode)) {
            modifierKeyDown = false;
        }
    };

    var checkModifierKeyDown = function(event) {
        if (isModifierKey(event.keyCode)) {
            modifierKeyDown = true;
        }
    };

    var handleBodyKeyDown = function(event) {
        switch (event.keyCode) {
            case 13: // Enter
                if (overviewActive) {
                    toggleOverview();
                }
                break;
            case 27: // ESC
                toggleOverview();
                break;
            case 37: // left arrow
            case 33: // page up
                event.preventDefault();
                prevSlide();
                break;
            case 39: // right arrow
            case 32: // space
            case 34: // page down
                event.preventDefault();
                nextSlide();
                break;
            case 50: // 2
                if (!modifierKeyDown) {
                        showNotes();
                }
                break;
            case 51: // 3
                if (!modifierKeyDown && !overviewActive) {
                    switch3D();
                }
                break;
            case 190: // .
            case 48: // 0
            case 66: // b
                if (!modifierKeyDown && !overviewActive) {
                    toggleBlank();
                }
                break;
            case 67: // c
                if (!modifierKeyDown && !overviewActive) {
                    toggleContext();
                }
                break;
            case 69: // e
                if (!modifierKeyDown && !overviewActive) {
                    expandSlides();
                }
                break;
            case 72: // h
                showHelp();
                break;
            case 78: // n
                if (!modifierKeyDown && !overviewActive) {
                    showSlideNumbers();
                }
                break;
            case 80: // p
                if (!modifierKeyDown && !overviewActive) {
                    showPresenterView();
                }
                break;
            case 83: // s
                if (!modifierKeyDown && !overviewActive) {
                    showSlideSources();
                }
                break;
            case 84: // t
                showToc();
                break;
        }
    };

    var handleWheel = function(event) {
        if (tocOpened || helpOpened || overviewActive) {
            return;
        }

        var delta = 0;

        if (!event) {
            event = window.event;
        }

        if (event.wheelDelta) {
            delta = event.wheelDelta/120;
            if (window.opera) delta = -delta;
        } else if (event.detail) {
            delta = -event.detail/3;
        }

        if (delta && delta <0) {
            nextSlide();
        } else if (delta) {
            prevSlide();
        }
    };

    var addSlideClickListeners = function() {
        for (var i=0; i < slides.length; i++) {
            var slide = slides.item(i);
            slide.num = i + 1;
            slide.addEventListener('click', function(e) {
                if (overviewActive) {
                    currentSlideNo = this.num;
                    toggleOverview();
                    updateSlideClasses(true);
                    e.preventDefault();
                }
                return false;
            }, true);
        }
    };

    var addRemoteWindowControls = function() {
        window.addEventListener("message", function(e) {
            if (e.data.indexOf("slide#") != -1) {
                    currentSlideNo = Number(e.data.replace('slide#', ''));
                    updateSlideClasses(false);
            }
        }, false);
    };

    var addTouchListeners = function() {
        document.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].pageX;
        }, false);
        document.addEventListener('touchend', function(e) {
            var pixelsMoved = touchStartX - e.changedTouches[0].pageX;
            var SWIPE_SIZE = 150;
            if (pixelsMoved > SWIPE_SIZE) {
                nextSlide();
            }
            else if (pixelsMoved < -SWIPE_SIZE) {
             prevSlide();
            }
        }, false);
    };

    var addTocLinksListeners = function() {
        var toc = document.getElementById('toc');
        if (toc) {
            var tocLinks = toc.getElementsByTagName('a');
            for (var i=0; i < tocLinks.length; i++) {
                tocLinks.item(i).addEventListener('click', function(e) {
                    currentSlideNo = Number(this.attributes['href'].value.replace('#slide', ''));
                    updateSlideClasses(true);
                    e.preventDefault();
                }, true);
            }
        }
    };

    // initialize

    (function() {
        if (window.location.hash == "") {
            currentSlideNo = 1;
        } else if (window.location.hash.indexOf("#presenter") != -1) {
            currentSlideNo = Number(window.location.hash.replace('#presenter', ''));
            isPresenterView = true;
            showingPresenterView = true;
            presenterViewWin = window;
            addClass(document.body, 'presenter_view');
        } else {
            currentSlideNo = Number(window.location.hash.replace('#slide', ''));
        }

        document.addEventListener('keyup', checkModifierKeyUp, false);
        document.addEventListener('keydown', handleBodyKeyDown, false);
        document.addEventListener('keydown', checkModifierKeyDown, false);
        document.addEventListener('DOMMouseScroll', handleWheel, false);

        document.onmousewheel = handleWheel;
        window.onresize = expandSlides;

        for (var i = 0, el; el = slides[i]; i++) {
            addClass(el, 'slide far-future');
        }
        updateSlideClasses(false);

        // add support for finger events (filter it by property detection?)
        addTouchListeners();

        addTocLinksListeners();

        addSlideClickListeners();

        addRemoteWindowControls();
    })();
}

    </script>
    
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-1">
          <div class="inner">
            
            <header><h1>Cloudera Data Analyst Training-Pig 翻译</h1></header>
            
            
            <section><p><img alt="" src="http://i.imgur.com/vf3OwjT.png" />
<span style="margin-left:750px;">by Gary</span></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              1/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-2">
          <div class="inner">
            
            <header><h1>Apache Pig</h1></header>
            
            
            <section><p># Apache Pig构建在Hadoop上以提供高级数据处理</p>
<ul>
<li>这是编写低级MapReduce代码的替代方法</li>
<li>Pig特别善于加入和转换数据<pre><code>people = LOAD '/user/training/customers' AS (cust_id, name);
orders = LOAD '/user/training/orders' AS (ord_id, cust_id, cost);
groups = GROUP orders BY cust_id;
totals = FOREACH groups GENERATE group, SUM(orders.cost) AS t;
result = JOIN totals BY group, people BY cust_id;
DUMP result;
</code></pre>
</li>
</ul>
<p># Pig解释器在客户端计算机上运行</p>
<ul>
<li>将PigLatin脚本转换为MapReduce作业</li>
<li>将这些作业提交到集群</li>
</ul>
<p><img src="http://i.imgur.com/vcMkOqa.png" height="100px" style="margin-left:750px;" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              2/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-3">
          <div class="inner">
            
            <header><h1>1.Pig简介</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              3/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-4">
          <div class="inner">
            
            <header><h1>Pig简介</h1></header>
            
            
            <section><p># 在本章中，您将学习</p>
<ul>
<li>Pig的主要特点</li>
<li>组织如何使用Pig进行数据处理和分析</li>
<li>如何以交互方式和批处理模式使用Pig</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              4/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-5">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig简介</p>
<ul>
<li><span style="color:red;"><strong>什么是Pig？</strong></span></li>
<li>Pig的功能</li>
<li>Pig用例</li>
<li>与Pig交互</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              5/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-6">
          <div class="inner">
            
            <header><h1>Apache Pig概述</h1></header>
            
            
            <section><p># Apache Pig是用于Hadoop的数据分析和处理的平台</p>
<ul>
<li>它提供了直接编写MapReduce代码的替代方法</li>
</ul>
<p># 最初在雅虎作为一个研究项目</p>
<ul>
<li>目标：灵活性、生产力和可维护性</li>
<li>现在是一个开源的Apache项目</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              6/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-7">
          <div class="inner">
            
            <header><h1>Pig解析</h1></header>
            
            
            <section><p># Pig的主要组件</p>
<ul>
<li>数据流语言（Pig Latin）</li>
<li>交互式shell您可以在其中键入Pig Latin语句（Grunt） </li>
<li>Pig解释器和执行引擎</li>
</ul>
<p><img src="http://i.imgur.com/OF82AlE.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              7/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-8">
          <div class="inner">
            
            <header><h1>从哪里获得Pig</h1></header>
            
            
            <section><p># CDH是安装Hadoop和Pig最简单的方法</p>
<ul>
<li>一个Hadoop分布式集群包括HDFS，MapReduce，Spark，Pig，Hive，Impala，Sqoop，HBase和其他Hadoop生态系统组件</li>
<li>可以使用RPM，Ubuntu/Debian/SuSE或tarball等形式的安装包</li>
<li>安装简单</li>
<li>100％免费和开源</li>
</ul>
<p># 安装不在本课程范围内</p>
<ul>
<li>可学习Cloudera的另外两门培训课程《System Administrators》和《Cloudera Administrator Training for Apache Hadoop》</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              8/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-9">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig简介</p>
<ul>
<li>什么是Pig？</li>
<li><span style="color:red;"><strong>Pig的功能</strong></span></li>
<li>Pig用例</li>
<li>与Pig交互</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              9/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-10">
          <div class="inner">
            
            <header><h1>Pig的功能</h1></header>
            
            
            <section><p># Pig是编写低级MapReduce代码的替代方法</p>
<p># 许多功能使Pig能够进行复杂的数据分析和处理 </p>
<ul>
<li>HDFS操作</li>
<li>UNIX shell命令</li>
<li>关系运算</li>
<li>字段的位置引用</li>
<li>常见的数学函数 </li>
<li>支持自定义函数和数据格式</li>
<li>复杂的数据结构 </li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              10/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-11">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig简介</p>
<ul>
<li>什么是Pig？</li>
<li>Pig的功能</li>
<li><span style="color:red;"><strong>Pig用例</strong></span></li>
<li>与Pig交互</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              11/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-12">
          <div class="inner">
            
            <header><h1>组织如何使用Pig</h1></header>
            
            
            <section><p># 许多组织使用Pig进行数据分析</p>
<ul>
<li>在海量数据集中查找相关记录</li>
<li>查询多个数据集</li>
<li>从输入数据计算值 </li>
</ul>
<p># Pig也经常用于数据处理 </p>
<ul>
<li>整合现有的数据集</li>
<li>连接来自多个源的数据以产生新的数据集</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              12/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-13">
          <div class="inner">
            
            <header><h1>用例：Web日志会话化</h1></header>
            
            
            <section><p># Pig可以帮助您从Web服务器日志文件中提取有价值的信息</p>
<p><img alt="" src="http://i.imgur.com/TzTjlqT.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              13/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-14">
          <div class="inner">
            
            <header><h1>用例：数据采样</h1></header>
            
            
            <section><p># 抽样可以帮助您探索大型数据集的代表性部分</p>
<ul>
<li>允许您使用不能缩放的工具检查此部分</li>
<li>在分析作业开发期间支持更快的迭代</li>
</ul>
<p><img alt="" src="http://i.imgur.com/pElkilN.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              14/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-15">
          <div class="inner">
            
            <header><h1>用例：ETL处理</h1></header>
            
            
            <section><p># Pig还广泛用于提取，转换和加载（ETL）处理</p>
<p><img alt="" src="http://i.imgur.com/WAfQQzH.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              15/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-16">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig简介</p>
<ul>
<li>什么是Pig？</li>
<li>Pig的功能</li>
<li>Pig用例</li>
<li><span style="color:red;"><strong>与Pig交互</strong></span></li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              16/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-17">
          <div class="inner">
            
            <header><h1>交互式使用Pig</h1></header>
            
            
            <section><p># 你可以通过Grunt shell交互地使用Pig</p>
<ul>
<li>Pig在键入时解释每个Pig Latin语句</li>
<li>执行被延迟直到需要输出时再执行</li>
<li>非常适用于临时数据检查</li>
</ul>
<p># 如何启动，使用和退出Grunt的示例</p>
<pre><code>$ pig
grunt&gt; allsales = LOAD 'sales' AS (name, price);
grunt&gt; bigsales = FILTER allsales BY price &gt; 100;
grunt&gt; STORE bigsales INTO 'myreport';
grunt&gt; quit;
</code></pre>
<p># 也可以通过-e从UNIX shell执行Pig Latin语句选项</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              17/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-18">
          <div class="inner">
            
            <header><h1>与HDFS交互</h1></header>
            
            
            <section><p># 可以通过fs命令使用Pig操作HDFS</p>
<pre><code>grunt&gt; fs -mkdir sales/;
grunt&gt; fs -put europe.txt sales/;
grunt&gt; allsales = LOAD 'sales' AS (name, price);
grunt&gt; bigsales = FILTER allsales BY price &gt; 100;
grunt&gt; STORE bigsales INTO 'myreport';
grunt&gt; fs -getmerge myreport/ bigsales.txt;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              18/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-19">
          <div class="inner">
            
            <header><h1>与UNIX交互</h1></header>
            
            
            <section><p># 使用sh命令可以从Pig运行UNIX程序</p>
<pre><code>grunt&gt; sh date;
Wed Nov 12 06:39:13 PST 2014
grunt&gt; fs -ls; -- lists HDFS files
grunt&gt; sh ls; -- lists local files
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              19/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-20">
          <div class="inner">
            
            <header><h1>运行Pig脚本</h1></header>
            
            
            <section><p># Pig脚本只是存储在文本文件中的Pig Latin代码</p>
<ul>
<li>按照惯例，这些文件具有.pig扩展名</li>
</ul>
<p># 可以通过运行命令从Grunt shell中运行Pig脚本</p>
<ul>
<li>这对于自动化和批处理执行很有用<pre><code>grunt&gt; run salesreport.pig;
</code></pre>
</li>
</ul>
<p># 通常直接从UNIX shell运行Pig脚本</p>
<pre><code>$ pig salesreport.pig
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              20/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-21">
          <div class="inner">
            
            <header><h1>MapReduce和本地模式</h1></header>
            
            
            <section><p># 如前所述，Pig将Pig Latin转换为MapReduce作业</p>
<ul>
<li>Pig提交这些作业以在Hadoop集群上执行</li>
</ul>
<p># 也可以使用x标志在本地模式下运行Pig</p>
<ul>
<li>这将在本地机器上而不是集群上运行作业</li>
<li>本地模式使用本地文件系统，而不是HDFS</li>
<li>
<p>在将作业部署到生产之前可以有助于测试</p>
<pre><code>$ pig –x local -- interactive
$ pig -x local salesreport.pig -- batch
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              21/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-22">
          <div class="inner">
            
            <header><h1>客户端日志文件</h1></header>
            
            
            <section><p># 如果作业失败，Pig可能会生成一个日志文件来解释为什么</p>
</li>
<li>
<p>这些日志文件通常在当前工作目录中生成</p>
<ul>
<li>在本地（客户端）机器上</li>
</ul>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              22/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-23">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig简介</p>
<ul>
<li>什么是Pig？</li>
<li>Pig的功能</li>
<li>Pig用例</li>
<li>与Pig交互</li>
<li><span style="color:red;"><strong>结论</strong></span></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              23/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-24">
          <div class="inner">
            
            <header><h1>基本要点</h1></header>
            
            
            <section><p># Pig提供了直接编写MapReduce代码的替代方法</p>
<ul>
<li>Pig解释Pig Latin代码以创建MapReduce作业</li>
<li>然后将这些作业提交到Hadoop集群</li>
</ul>
<p># 可以通过Grunt交互地执行Pig Latin代码</p>
<ul>
<li>Pig延迟作业执行，直到需要输出</li>
</ul>
<p># 在用于批处理执行的脚本中存储Pig Latin代码也是常见的</p>
<ul>
<li>允许自动化和代码重用</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              24/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-25">
          <div class="inner">
            
            <header><h1>2.基本数据分析</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              25/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-26">
          <div class="inner">
            
            <header><h1>基本数据分析</h1></header>
            
            
            <section><p># 在本章中，您将学习</p>
<ul>
<li>Pig Latin的基本语法</li>
<li>如何使用Pig加载和存储数据</li>
<li>Pig使用哪些简单数据类型来表示数据</li>
<li>如何在Pig中排序和过滤数据</li>
<li>如何使用许多Pig的内置函数进行数据处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              26/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-27">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li><span style="color:red;"><strong>Pig Latin语法</strong></span></li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              27/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-28">
          <div class="inner">
            
            <header><h1>Pig Latin概述</h1></header>
            
            
            <section><p># Pig Latin是一种数据流语言</p>
<ul>
<li>数据流表示为语句序列</li>
</ul>
<p># 以下是一个简单的Pig Latin脚本，用于加载，过滤和存储数据</p>
<pre><code>allsales = LOAD 'sales' AS (name, price);
bigsales = FILTER allsales BY price &gt; 999; -- in US cents
/*
 * Save the filtered results into a new
 * directory, below my home directory.
 */
STORE bigsales INTO 'myreport';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              28/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-29">
          <div class="inner">
            
            <header><h1>Pig Latin语法：关键词</h1></header>
            
            
            <section><p># Pig Latin关键字在此以蓝色文本突出显示</p>
<ul>
<li>关键字保留 - 您不能使用它们来命名事物</li>
</ul>
<p><img src="http://i.imgur.com/sPscrEb.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              29/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-30">
          <div class="inner">
            
            <header><h1>Pig Latin语法：标识符(1)</h1></header>
            
            
            <section><p># 标识符是分配给字段和其他数据结构的名称</p>
<p><img src="http://i.imgur.com/ktiwp7f.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              30/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-31">
          <div class="inner">
            
            <header><h1>Pig Latin语法：标识符(2)</h1></header>
            
            
            <section><p># 标识符必须符合Pig的命名规则</p>
<p># 标识符必须始终以字母开头</p>
<ul>
<li>这只能后跟字母，数字或下划线</li>
</ul>
<p><img alt="" src="http://i.imgur.com/8xgG3UX.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              31/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-32">
          <div class="inner">
            
            <header><h1>Pig Latin语法：注释</h1></header>
            
            
            <section><p># Pig Latin支持两种类型的注释</p>
<ul>
<li>单行注释以 -- 开始</li>
<li>多行注释以 /<em> 开头，以 </em>/ 结束<pre><code>allsales = LOAD 'sales' AS (name, price);
bigsales = FILTER allsales BY price &gt; 999; -- in US cents
/*
 * Save the filtered results into a new
 * directory, below my home directory.
 */
STORE bigsales INTO 'myreport';
</code></pre>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              32/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-33">
          <div class="inner">
            
            <header><h1>Pig Latin对大小写敏感</h1></header>
            
            
            <section><p># 在Pig Latin中大小写是否重要取决于上下文</p>
<p># 关键字（此处显示为蓝色文字）不区分大小写</p>
<ul>
<li>也不是运算符（例如AND，OR或IS NULL）</li>
</ul>
<p># 标识符和路径（此处以红色文字显示）区分大小写</p>
<ul>
<li>函数名（例如SUM或COUNT）和常量也是如此</li>
</ul>
<p><img alt="" src="http://i.imgur.com/DoeiEaB.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              33/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-34">
          <div class="inner">
            
            <header><h1>Pig Latin中的常用运算符</h1></header>
            
            
            <section><p># Pig Latin中的许多常用运算符对SQL用户很熟悉</p>
<ul>
<li>显着差异：Pig Latin使用==和！=进行比较</li>
</ul>
<p><img alt="" src="http://i.imgur.com/r6kEZ3g.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              34/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-35">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li>Pig Latin语法</li>
<li><span style="color:red;"><strong>加载数据</strong></span></li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              35/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-36">
          <div class="inner">
            
            <header><h1>Pig中加载基本数据</h1></header>
            
            
            <section><p># Pig的默认加载函数称为PigStorage</p>
<ul>
<li>调用LOAD时，函数的名称是隐式的</li>
<li>PigStorage呈现文本格式使用制表符来分隔列</li>
</ul>
<p># 考虑HDFS中名为sales的以下文件</p>
<ul>
<li>这两个字段由制表符字符分隔<pre><code>Alice       2999
Bob         3625
Carlos      2764
</code></pre>
</li>
</ul>
<p># 此示例从上面的文件加载数据 </p>
<pre><code>allsales = LOAD 'sales' AS (name, price);
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              36/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-37">
          <div class="inner">
            
            <header><h1>数据源：文件和目录</h1></header>
            
            
            <section><p># 上一个示例从名为sales的文件加载数据</p>
<pre><code>allsales = LOAD 'sales' AS (name, price);
</code></pre>
<p># 因为这不是一个绝对路径，它是相对于你的home目录</p>
<ul>
<li>HDFS中的home目录通常为/user/youruserid/</li>
<li>也可以指定绝对路径（例如/dept/sales/2012/q4）</li>
</ul>
<p># 该路径也可以引用一个目录 </p>
<ul>
<li>在这种情况下，Pig将递归加载该目录中的所有文件</li>
<li>
<p>还支持文件模式（“globs”）</p>
<pre><code>allsales = LOAD 'sales_200[5-9]' AS (name, price);
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              37/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-38">
          <div class="inner">
            
            <header><h1>在加载期间指定列名称</h1></header>
            
            
            <section><p># 前面的示例还为每个列分配了名称</p>
<p>allsales = LOAD 'sales' AS (name, price);</p>
</li>
</ul>
<p># 不需要指定列名称</p>
<ul>
<li>这在探索新数据集时很有用</li>
<li>按位置引用字段（$0是第一个，$1是第二个，$53是第54个等等） <pre><code>allsales = LOAD 'sales';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              38/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-39">
          <div class="inner">
            
            <header><h1>使用备用列分隔符</h1></header>
            
            
            <section><p># 您可以将备用分隔符指定为PigStorage的参数</p>
</li>
</ul>
<p># 此示例显示如何加载逗号分隔的数据</p>
<ul>
<li>注意这是一个单独的语句<pre><code>allsales = LOAD 'sales.csv' USING PigStorage(',') AS (name, price);
</code></pre>
</li>
</ul>
<p># 或者加载管道分隔的数据而不指定列名称</p>
<pre><code>allsales = LOAD 'sales.txt' USING PigStorage('|');
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              39/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-40">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li>Pig Latin语法</li>
<li>加载数据</li>
<li><span style="color:red;"><strong>简单数据类型</strong></span></li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              40/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-41">
          <div class="inner">
            
            <header><h1>Pig中的简单数据类型</h1></header>
            
            
            <section><p># Pig支持几种基本数据类型</p>
<ul>
<li>类似于大多数数据库和编程语言</li>
</ul>
<p># Pig将未指定类型的字段视为字节数组</p>
<ul>
<li>在Pig中调用bytearray类型<pre><code>allsales = LOAD 'sales' AS (name, price);
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              41/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-42">
          <div class="inner">
            
            <header><h1>简单数据类型列表</h1></header>
            
            
            <section><p># 对于简单值，Pig中有八种数据类型</p>
</li>
</ul>
<p><img src="http://i.imgur.com/ATFvRzr.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              42/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-43">
          <div class="inner">
            
            <header><h1>在Pig中指定数据类型</h1></header>
            
            
            <section><p># Pig将尽最大努力根据上下文来确定数据类型</p>
<ul>
<li>例如，您可以计算销售佣金为price * 0.1</li>
<li>在这种情况下，Pig将认为此值的类型为double</li>
</ul>
<p># 但是，最好在可能的情况下明确指定数据类型</p>
<ul>
<li>有助于进行错误检查和优化</li>
<li>最简单的做法是在加载时使用格式fieldname：type<pre><code>allsales = LOAD 'sales' AS (name:chararray, price:int);
</code></pre>
</li>
</ul>
<p># 选择正确的数据类型对于避免精度损失很重要</p>
<p># 重要提示：避免使用浮点数表示货币！</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              43/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-44">
          <div class="inner">
            
            <header><h1>Pig如何处理无效数据</h1></header>
            
            
            <section><p># 遇到无效数据时，Pig将值替换为NULL</p>
<ul>
<li>例如，一个包含值Q4的int字段</li>
</ul>
<p># IS NULL和IS NOT NULL运算符测试空值</p>
<ul>
<li>注意，NULL不同于空字符串''</li>
</ul>
<p># 您可以使用这些运算符过滤坏记录</p>
<pre><code>hasprices = FILTER Records BY price IS NOT NULL;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              44/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-45">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li>Pig Latin语法</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li><span style="color:red;"><strong>字段定义</strong></span></li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              45/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-46">
          <div class="inner">
            
            <header><h1>Pig中的关键数据概念</h1></header>
            
            
            <section><p># 关系数据库具有表，行，列和字段</p>
<p># 我们将使用以下数据来说明Pig的等价物</p>
<ul>
<li>假设此数据是从制表符分隔的文本文件中加载的</li>
</ul>
<p><img alt="" src="http://i.imgur.com/OiGg9AS.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              46/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-47">
          <div class="inner">
            
            <header><h1>Pig数据概念：Fields</h1></header>
            
            
            <section><p># 单个数据元素称为字段</p>
<ul>
<li>它对应于前面看到的八种数据类型之一</li>
</ul>
<p><img alt="" src="http://i.imgur.com/R7z5Dkx.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              47/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-48">
          <div class="inner">
            
            <header><h1>Pig数据概念：Tuples</h1></header>
            
            
            <section><p># 值的集合称为元组</p>
<ul>
<li>元组中的字段是有序的，但不必都是相同类型的</li>
</ul>
<p><img alt="" src="http://i.imgur.com/MHf4twC.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              48/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-49">
          <div class="inner">
            
            <header><h1>Pig数据概念：Bags</h1></header>
            
            
            <section><p># 元组的集合称为包</p>
<p># 默认情况下，包中的元组是无序的</p>
<ul>
<li>字段计数和类型可以在包中的元组之间变化</li>
</ul>
<p><img alt="" src="http://i.imgur.com/3bG2Adm.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              49/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-50">
          <div class="inner">
            
            <header><h1>Pig数据概念：Relations</h1></header>
            
            
            <section><p># 关系只是一个具有指定名称（别名）的包</p>
<ul>
<li>大多数Pig Latin语句都会创建一个新的关系</li>
</ul>
<p># 典型的脚本将一个或多个数据集加载到关系中</p>
<ul>
<li>处理数据创建新关系而不是修改现有关系</li>
<li>
<p>最终结果通常也是一个关系，存储为输出</p>
<pre><code>allsales = LOAD 'sales' AS (name, price);
bigsales = FILTER allsales BY price &gt; 999;
STORE bigsales INTO 'myreport';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              50/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-51">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
</li>
<li>
<p>Pig Latin语法</p>
</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li><span style="color:red;"><strong>数据输出</strong></span></li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              51/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-52">
          <div class="inner">
            
            <header><h1>Pig中的数据输出</h1></header>
            
            
            <section><p># 用于处理输出的命令取决于输出的目标</p>
<ul>
<li>DUMP：将输出发送到屏幕</li>
<li>STORE：将输出发送到磁盘（HDFS）</li>
</ul>
<p># DUMP输出示例，使用之前显示的文件中的数据</p>
<ul>
<li>
<p>括号和逗号表示具有多个字段的元组</p>
<pre><code>(Alice,2999,us)
(Bob,3625,ca)
(Carlos,2764,mx)
(Dieter,1749,de)
(Étienne,2368,fr)
(Fredo,5637,it)
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              52/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-53">
          <div class="inner">
            
            <header><h1>使用Pig存储数据</h1></header>
            
            
            <section><p># STORE命令用于将数据存储到HDFS</p>
</li>
<li>
<p>类似于LOAD，但是写入数据而不是读取</p>
</li>
<li>输出路径是目录的名称<ul>
<li>该目录不能存在                          </li>
</ul>
</li>
</ul>
<p># 与LOAD一样，PigStorage的使用是隐式的</p>
<ul>
<li>
<p>字段分隔符也有一个默认值（tab）</p>
<pre><code>STORE bigsales INTO 'myreport';
</code></pre>
</li>
<li>
<p>您还可以指定备用分隔符</p>
<pre><code>STORE bigsales INTO 'myreport' USING PigStorage(',');
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              53/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-54">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
</li>
<li>
<p>Pig Latin语法</p>
</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li><span style="color:red;"><strong>查看模式</strong></span></li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              54/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-55">
          <div class="inner">
            
            <header><h1>使用DESCRIBE查看模式</h1></header>
            
            
            <section><p># DESCRIBE命令显示数据的结构，包括名称和类型                </p>
<p># 下面的Grunt会话显示了一个例子</p>
<p><img alt="" src="http://i.imgur.com/rRNRLnR.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              55/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-56">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li>Pig Latin语法</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li><span style="color:red;"><strong>过滤和排序数据</strong></span></li>
<li>常用函数</li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              56/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-57">
          <div class="inner">
            
            <header><h1>Pig Latin中过滤</h1></header>
            
            
            <section><p># FILTER关键字提取符合指定条件的元组</p>
<pre><code>bigsales = FILTER allsales BY price &gt; 3000;
</code></pre>
<p><img src="http://i.imgur.com/IsUpfei.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              57/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-58">
          <div class="inner">
            
            <header><h1>按多个条件过滤</h1></header>
            
            
            <section><p># 您可以将条件用AND和OR组合</p>
<pre><code>somesales = FILTER allsales BY name == 'Dieter' OR (price &gt; 3500 AND price &lt; 4000);
</code></pre>
<p><img src="http://i.imgur.com/UpfLkaf.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              58/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-59">
          <div class="inner">
            
            <header><h1>Aside：在Pig Latin中String的比较</h1></header>
            
            
            <section><p># Pig Latin中的任何类型都支持==运算符</p>
<ul>
<li>此运算符用于精确比较<pre><code>alices = FILTER allsales BY name == 'Alice';
</code></pre>
</li>
</ul>
<p># Pig Latin支持通过Java正则表达式进行模式匹配</p>
<ul>
<li>
<p>这是使用MATCHES运算符完成的</p>
<pre><code>a_names = FILTER allsales BY name MATCHES 'A.*';

spammers = FILTER senders BY email_addr MATCHES '.*@example\\.com$';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              59/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-60">
          <div class="inner">
            
            <header><h1>Pig Latin中的字段选择</h1></header>
            
            
            <section><p># 过滤提取行，但有时我们需要提取列</p>
</li>
<li>
<p>这是使用FOREACH和GENERATE关键字在Pig Latin中完成的</p>
<pre><code>twofields = FOREACH allsales GENERATE amount, trans_id;
</code></pre>
</li>
</ul>
<p><img alt="" src="http://i.imgur.com/daTDvRp.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              60/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-61">
          <div class="inner">
            
            <header><h1>在Pig Latin中生成新字段</h1></header>
            
            
            <section><p># FOREACH和GENERATE关键字也可用于创建字段</p>
<ul>
<li>例如，您可以根据price创建一个新字段<pre><code>t = FOREACH allsales GENERATE price * 0.07;
</code></pre>
</li>
</ul>
<p># 可以命名这样的字段</p>
<pre><code>t = FOREACH allsales GENERATE price * 0.07 AS tax;
</code></pre>
<p># 还可以指定数据类型</p>
<pre><code>t = FOREACH allsales GENERATE price * 0.07 AS tax:float;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              61/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-62">
          <div class="inner">
            
            <header><h1>消除重复</h1></header>
            
            
            <section><p># DISTINCT删除bag中的重复记录</p>
<ul>
<li>所有字段必须相等，才能被视为重复<pre><code>unique_records = DISTINCT all_alices;
</code></pre>
</li>
</ul>
<p><img src="http://i.imgur.com/wUfYtaT.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              62/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-63">
          <div class="inner">
            
            <header><h1>控制排序顺序</h1></header>
            
            
            <section><p># 使用ORDER ... BY按升序对bag中的记录进行排序</p>
<ul>
<li>添加DESC以按降序排序</li>
<li>注意指定模式 - 数据类型会影响数据的排序方式！<pre><code>sortedsales = ORDER allsales BY country DESC;
</code></pre>
</li>
</ul>
<p><img src="http://i.imgur.com/KXJZ18l.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              63/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-64">
          <div class="inner">
            
            <header><h1>限制结果</h1></header>
            
            
            <section><p># 与在SQL中一样，您可以使用LIMIT来减少输出记录的数量</p>
<pre><code>somesales = LIMIT allsales 10;
</code></pre>
<p># 谨防！ 记录排序是随机的，除非使用ORDER BY指定</p>
<ul>
<li>
<p>使用ORDER BY和LIMIT一起查找前N个结果</p>
<pre><code>sortedsales = ORDER allsales BY price DESC;
top_five = LIMIT sortedsales 5;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              64/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-65">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
</li>
<li>
<p>Pig Latin语法</p>
</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li><span style="color:red;"><strong>常用函数</strong></span></li>
<li>结论</li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              65/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-66">
          <div class="inner">
            
            <header><h1>内置函数</h1></header>
            
            
            <section><p># 这些只是Pig的许多内置函数的一个示例</p>
<p><img src="http://i.imgur.com/lW8fOyt.png" width="853px" />         </p>
<p># 您可以通过FOREACH..GENERATE关键字来使用这些内置函数</p>
<pre><code>rounded = FOREACH allsales GENERATE ROUND(price);
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              66/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-67">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li>Pig Latin语法</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li><span style="color:red;"><strong>结论</strong></span></li>
<li>实践练习：使用Pig进行ETL处理</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              67/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-68">
          <div class="inner">
            
            <header><h1>基本要点</h1></header>
            
            
            <section><p># Pig Latin支持许多与SQL相同的操作</p>
<ul>
<li>虽然Pig的方法是完全不同的</li>
<li>Pig Latin在一系列步骤中加载，转换和存储数据        </li>
</ul>
<p># 输入和输出的默认分隔符是制表符Tab字符</p>
<ul>
<li>您可以将备用分隔符指定为PigStorage的参数</li>
</ul>
<p># 不需要指定字段的名称和类型</p>
<ul>
<li>但它可以提高代码的性能和可读性</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              68/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-69">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 基本数据分析</p>
<ul>
<li>Pig Latin语法</li>
<li>加载数据</li>
<li>简单数据类型</li>
<li>字段定义</li>
<li>数据输出</li>
<li>查看模式</li>
<li>过滤和排序数据</li>
<li>常用函数</li>
<li>结论</li>
<li><span style="color:red;"><strong>实践练习：使用Pig进行ETL处理</strong></span></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              69/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-70">
          <div class="inner">
            
            <header><h1>3.用Pig处理复杂数据</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              70/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-71">
          <div class="inner">
            
            <header><h1>用Pig处理复杂数据</h1></header>
            
            
            <section><p># 在本章中，您将学习</p>
<ul>
<li>Pig如何使用包，元组和映射来表示复杂数据</li>
<li>Pig提供的用于分组和取消分组数据的技术</li>
<li>如何在Pig Latin中使用聚合函数</li>
<li>如何遍历复杂数据结构中的记录</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              71/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-72">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li><span style="color:red;"><strong>存储格式</strong></span></li>
<li>复杂/嵌套数据类型</li>
<li>分组</li>
<li>处理复杂数据的内置函数</li>
<li>迭代分组数据</li>
<li>结论</li>
<li>实践练习：使用Pig分析广告系列数据</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              72/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-73">
          <div class="inner">
            
            <header><h1>存储格式</h1></header>
            
            
            <section><p># 我们已经看到PigStorage加载和存储数据</p>
<ul>
<li>使用分隔的文本文件格式<pre><code>allsales = LOAD 'sales' AS (name, price);
</code></pre>
<ul>
<li>
<p>默认分隔符（制表符Tab）可以轻松更改</p>
<p>allsales = LOAD 'sales' USING PigStorage(',') AS (name, price) ;</p>
</li>
</ul>
</li>
</ul>
<p># 有时您需要加载或存储其他格式的数据</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              73/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-74">
          <div class="inner">
            
            <header><h1>其他支持的格式</h1></header>
            
            
            <section><p># 这里有几个Pig的内置函数用于加载其他格式的数据</p>
<ul>
<li>也可以通过编写Java代码来实现自定义加载器</li>
</ul>
<p><img src="http://i.imgur.com/BbHGmgC.png" width="853px" /> </p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              74/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-75">
          <div class="inner">
            
            <header><h1>加载和存储函数</h1></header>
            
            
            <section><p># 一些函数加载数据，一些存储数据，还有一些函数两者都做</p>
<p><img alt="" src="http://i.imgur.com/6ASX2n2.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              75/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-76">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li>存储格式</li>
<li><span style="color:red;"><strong>复杂/嵌套数据类型</strong></span></li>
<li>分组</li>
<li>处理复杂数据的内置函数</li>
<li>迭代分组数据</li>
<li>结论</li>
<li>实践练习：使用Pig分析广告系列数据</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              76/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-77">
          <div class="inner">
            
            <header><h1>Pig的复杂数据类型：Tuple和Bag</h1></header>
            
            
            <section><p># 我们已经看到了Pig的三种复杂数据类型中的两种</p>
<ul>
<li>元组是值的集合</li>
<li>包是元组的集合</li>
</ul>
<p><img alt="" src="http://i.imgur.com/52jzUmo.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              77/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-78">
          <div class="inner">
            
            <header><h1>Pig的复杂数据类型：Map</h1></header>
            
            
            <section><p># Pig还支持另一种复杂类型：映射</p>
<ul>
<li>映射将字符（键）与另一个数据的元素（值）联合在一起</li>
</ul>
<p><img alt="" src="http://i.imgur.com/gFq1Mq6.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              78/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-79">
          <div class="inner">
            
            <header><h1>在Pig中表示复杂类型</h1></header>
            
            
            <section><p># 重要的是要知道如何在Pig中定义和识别这些类型</p>
<p><img src="http://i.imgur.com/0MYEbu3.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              79/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-80">
          <div class="inner">
            
            <header><h1>加载和使用复杂类型(1)</h1></header>
            
            
            <section><p># 复杂数据类型可用于任何Pig字段</p>
<p># 以下示例显示包是如何存储在文本文件中的</p>
<ul>
<li>示例：交易ID，金额，已售商品（元组组成的一个包）</li>
</ul>
<p><img alt="" src="http://i.imgur.com/NKGWKhW.png" />
 # 这里是相应的LOAD语句指定模式</p>
<pre><code>details = LOAD 'salesdetail' AS (   
trans_id:chararray, amount:int,
items_sold:bag
    {item:tuple (SKU:chararray, price:int)});
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              80/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-81">
          <div class="inner">
            
            <header><h1>加载和使用复杂类型(2)</h1></header>
            
            
            <section><p># 以下示例显示映射是如何存储在文本文件中的</p>
<ul>
<li>示例：客户名称，信用账户详细信息（映射），年度账户开立</li>
</ul>
<p><img alt="" src="http://i.imgur.com/siyIqfV.png" />
 # 这里是相应的LOAD语句指定模式</p>
<pre><code>credit = LOAD 'customer_accounts' AS (
name:chararray, account:map[], year:int);
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              81/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-82">
          <div class="inner">
            
            <header><h1>引用映射数据</h1></header>
            
            
            <section><p># 思考具有以下数据的文件</p>
<pre><code>Bob [salary#52000,age#52]
</code></pre>
<p># 并加载以下模式</p>
<pre><code>details = LOAD 'data' AS (name:chararray, info:map[]);
</code></pre>
<p># 以下是在map和bag中引用数据的语法</p>
<pre><code>salaries = FOREACH details GENERATE info#'salary';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              82/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-83">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li>存储格式</li>
<li>复杂/嵌套数据类型</li>
<li><span style="color:red;"><strong>分组</strong></span></li>
<li>处理复杂数据的内置函数</li>
<li>迭代分组数据</li>
<li>结论</li>
<li>实践练习：使用Pig分析广告系列数据</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              83/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-84">
          <div class="inner">
            
            <header><h1>按字段对记录进行分组(1)</h1></header>
            
            
            <section><p># 有时您需要通过给定字段对记录进行分组</p>
<ul>
<li>例如，您可以计算每个员工的佣金<pre><code>Alice 729
Bob 3999
Alice 27999
Carol 32999
Carol 4999
</code></pre>
</li>
</ul>
<p># 使用GROUP BY在Pig Latin中执行此操作</p>
<ul>
<li>新关系在指定字段中具有每个唯一值的一个记录<pre><code>byname = GROUP sales BY name;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              84/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-85">
          <div class="inner">
            
            <header><h1>按字段对记录进行分组(2)</h1></header>
            
            
            <section><p># 新关系总是包含两个字段</p>
</li>
</ul>
<p><img alt="" src="http://i.imgur.com/9BdoPd6.png" />
 # 第一个字段在所有情况下都是字面上命名的组</p>
<ul>
<li>包含GROUP BY中指定的字段的值</li>
</ul>
<p># 第二个字段按照GROUP BY中指定的关系命名</p>
<ul>
<li>它是一个包含每个对应值的一个元组的包</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              85/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-86">
          <div class="inner">
            
            <header><h1>按字段对记录进行分组(3)</h1></header>
            
            
            <section><p># 下面的示例显示了分组后的数据</p>
<p><img src="http://i.imgur.com/ZYsNhlj.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              86/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-87">
          <div class="inner">
            
            <header><h1>使用GROUP BY聚合数据</h1></header>
            
            
            <section><p># 聚合函数从多个输入值创建一个输出值</p>
<ul>
<li>例如，计算员工的总销售额</li>
<li>通常应用于分组数据</li>
</ul>
<p><img src="http://i.imgur.com/nd1rzeX.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              87/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-88">
          <div class="inner">
            
            <header><h1>将所有内容分组到单个记录</h1></header>
            
            
            <section><p># 我们只看到GROUP BY为每个唯一值创建一个记录</p>
<p># GROUP ALL将所有数据放入一个记录</p>
<p><img alt="" src="http://i.imgur.com/V6zc9Ld.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              88/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-89">
          <div class="inner">
            
            <header><h1>使用GROUP ALL聚合数据</h1></header>
            
            
            <section><p># 当需要聚合一个或多个列时，使用GROUP ALL</p>
<ul>
<li>例如，计算所有员工的总销售额</li>
</ul>
<p><img src="http://i.imgur.com/CAxQhO2.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              89/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-90">
          <div class="inner">
            
            <header><h1>删除数据中的嵌套</h1></header>
            
            
            <section><p># Pig中的一些操作（如分组）会生成嵌套数据结构</p>
<p><img alt="" src="http://i.imgur.com/1zVo2Be.png" /></p>
<p># 分组可用于向聚合函数提供数据</p>
<p># 但是，有时候你想使用一个“扁平”的数据结构</p>
<ul>
<li>FLATTEN操作符删除数据中的嵌套级别</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              90/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-91">
          <div class="inner">
            
            <header><h1>FLATTEN的示例</h1></header>
            
            
            <section><p># 下面显示了嵌套数据和FLATTEN对它的影响</p>
<p><img alt="" src="http://i.imgur.com/G0jtBSo.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              91/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-92">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li>存储格式</li>
<li>复杂/嵌套数据类型</li>
<li>分组</li>
<li><span style="color:red;"><strong>处理复杂数据的内置函数</strong></span></li>
<li>迭代分组数据</li>
<li>结论</li>
<li>实践练习：使用Pig分析广告系列数据</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              92/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-93">
          <div class="inner">
            
            <header><h1>Pig的内置聚合函数</h1></header>
            
            
            <section><p># Pig内置支持除SUM之外的其他聚合函数</p>
<p># 例子：</p>
<ul>
<li>AVG：计算所有值的平均值（平均值）</li>
<li>MIN：返回最小值</li>
<li>MAX：返回最大值</li>
</ul>
<p># Pig有两个内置函数用于计数记录</p>
<ul>
<li>COUNT：返回包中非空元素的数量</li>
<li>COUNT_STAR：返回包中所有元素的数量</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              93/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-94">
          <div class="inner">
            
            <header><h1>其他值得注意的内置函数</h1></header>
            
            
            <section><p># 这里有一些其他有用的Pig函数</p>
<ul>
<li>有关完整列表，请参阅Pig文档</li>
</ul>
<p><img alt="" src="http://i.imgur.com/pMwtFRu.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              94/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-95">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li>存储格式</li>
<li>复杂/嵌套数据类型</li>
<li>分组</li>
<li>处理复杂数据的内置函数</li>
<li><span style="color:red;"><strong>迭代分组数据</strong></span></li>
<li>结论</li>
<li>实践练习：使用Pig分析广告系列数据</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              95/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-96">
          <div class="inner">
            
            <header><h1>记录迭代</h1></header>
            
            
            <section><p># 我们已经看到FOREACH ... GENERATE遍历记录</p>
<p># 目标是转换记录以产生新的关系</p>
<ul>
<li>
<p>有时只选择某些列</p>
<pre><code>price_column_only = FOREACH sales GENERATE price;
</code></pre>
<ul>
<li>
<p>有时创建新列</p>
<p>taxes = FOREACH sales GENERATE price * 0.07;
 - 有时对数据调用一个函数</p>
<p>totals = FOREACH grouped GENERATE SUM(sales.price);</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              96/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-97">
          <div class="inner">
            
            <header><h1>嵌套FOREACH关键字</h1></header>
            
            
            <section><p># 我们已经看到FOREACH ... GENERATE遍历记录</p>
</li>
</ul>
</li>
<li>
<p>这通常用于在组中应用一系列变换</p>
</li>
</ul>
<p># 这称为嵌套FOREACH</p>
<ul>
<li>仅允许关系操作（例如，LIMIT，FILTER，ORDER BY）</li>
<li>GENERATE必须是块中的最后一行</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              97/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-98">
          <div class="inner">
            
            <header><h1>嵌套FOREACH示例(1)</h1></header>
            
            
            <section><p># 我们的输入数据包含员工列表职位和相应的薪金</p>
<p># 目标：确定每个职称内三个最高的工资</p>
<p><img src="http://i.imgur.com/Co4Lm92.png" height="480px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              98/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-99">
          <div class="inner">
            
            <header><h1>嵌套FOREACH示例(2)</h1></header>
            
            
            <section><p># 首先从文件加载数据</p>
<p># 接下来，按职称对员工进行分组</p>
<ul>
<li>分配给新关系title_group</li>
</ul>
<p><img src="http://i.imgur.com/486IVCc.png" height="180px" />
<img src="http://i.imgur.com/SaQFZae.png"  /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              99/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-100">
          <div class="inner">
            
            <header><h1>嵌套FOREACH示例(3)</h1></header>
            
            
            <section><p># 嵌套FOREACH遍历每个记录（即每个作业标题）</p>
<ul>
<li>按照工资降序它对该组中的每个记录进行排序</li>
<li>然后选择前三个</li>
<li>GENERATE输出职称和薪水</li>
</ul>
<p><img src="http://i.imgur.com/0IrWyV0.png" height="160px" />
<img src="http://i.imgur.com/Kqd76q1.png" height="240px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              100/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-101">
          <div class="inner">
            
            <header><h1>嵌套FOREACH示例(4)</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/ekZ6a4B.png" width="830px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              101/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-102">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li>存储格式</li>
<li>复杂/嵌套数据类型</li>
<li>分组</li>
<li>处理复杂数据的内置函数</li>
<li>迭代分组数据</li>
<li><span style="color:red;"><strong>结论</strong></span></li>
<li>实践练习：使用Pig分析广告系列数据</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              102/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-103">
          <div class="inner">
            
            <header><h1>基本要点</h1></header>
            
            
            <section><p># Pig有三种复杂的数据类型：tuple，bag和map</p>
<ul>
<li>映射只是键/值对的集合</li>
</ul>
<p># 这些结构可以包含简单类型，如int或chararray</p>
<ul>
<li>但它们也可以包含复杂的数据类型</li>
<li>嵌套数据结构在Pig中很常见</li>
</ul>
<p># Pig提供了对数据进行分组和取消分组的方法</p>
<ul>
<li>您可以使用FLATTEN运算符删除嵌套级别</li>
</ul>
<p># Pig提供了几个内置的聚合函数</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              103/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-104">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 用Pig处理复杂数据</p>
<ul>
<li>存储格式</li>
<li>复杂/嵌套数据类型</li>
<li>分组</li>
<li>处理复杂数据的内置函数</li>
<li>迭代分组数据</li>
<li>结论</li>
<li><span style="color:red;"><strong>实践练习：使用Pig分析广告系列数据</strong></span></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              104/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-105">
          <div class="inner">
            
            <header><h1>实践练习：使用Pig分析广告系列数据</h1></header>
            
            
            <section><p># 在本练习中，您将分析来自Dualcore的在线广告系列的数据</p>
<p># 有关说明，请参阅实践练习手册</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              105/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-106">
          <div class="inner">
            
            <header><h1>4.使用Pig的多数据集操作</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              106/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-107">
          <div class="inner">
            
            <header><h1>使用Pig的多数据集操作</h1></header>
            
            
            <section><p># 在本章中，您将学习</p>
<ul>
<li>我们如何使用分组来组合来自多个来源的数据</li>
<li>Pig支持哪些类型的联接操作以及如何使用它们</li>
<li>如何连接记录以生成单个数据集</li>
<li>如何将单个数据集拆分为多个关系</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              107/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-108">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 使用Pig的多数据集操作</p>
<ul>
<li><span style="color:red;"><strong>组合数据集的技术</strong></span></li>
<li>在Pig中连接数据集</li>
<li>设置操作</li>
<li>拆分数据集</li>
<li>结论</li>
<li>实践练习：使用Pig分析不同的数据集</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              108/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-109">
          <div class="inner">
            
            <header><h1>组合数据集概述</h1></header>
            
            
            <section><p># 到目前为止，我们集中在处理单个数据集</p>
<ul>
<li>有价值的洞察通常来自组合多个数据集</li>
</ul>
<p># Pig提供了几种实现这一点的技术</p>
<ul>
<li>使用具有多个关系的GROUP运算符</li>
<li>像在SQL中一样加入数据</li>
<li>执行集合操作，如CROSS和UNION</li>
</ul>
<p># 我们将在本章中讨论这些内容</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              109/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-110">
          <div class="inner">
            
            <header><h1>示例数据集（1）</h1></header>
            
            
            <section><p># 本章中的大多数示例将涉及相同的两个数据集</p>
<p># 第一个是包含有关Dualcore的商店信息的文件</p>
<p># 此关系中有两个字段</p>
<p>1.store_id:chararray（主键）</p>
<p>2.商店所在城市的名称</p>
<p><img alt="" src="http://i.imgur.com/9YtlMnr.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              110/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-111">
          <div class="inner">
            
            <header><h1>示例数据集（2）</h1></header>
            
            
            <section><p># 我们的其他数据集是一个包含有关Dualcore销售人员信息的文件</p>
<p># 此关系包含三个字段</p>
<p>1.person_id:int（主键）</p>
<p>2.name:chararray（销售员名称）</p>
<p>3.store_id:chararray（指商店）</p>
<p><img src="http://i.imgur.com/qkmvBOh.png" height="350px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              111/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-112">
          <div class="inner">
            
            <header><h1>分组多重关系</h1></header>
            
            
            <section><p># 我们之前学到了GROUP运算符</p>
<ul>
<li>基于指定字段的关系中的组值</li>
</ul>
<p># GROUP运算符还可以对多个关系进行分组</p>
<ul>
<li>在这种情况下，优选使用同义COGROUP运算符<pre><code>grouped = COGROUP stores BY store_id, salespeople BY store_id;
</code></pre>
</li>
</ul>
<p># 这会将两个数据集中的值收集到一个新关系中</p>
<ul>
<li>
<p>如前所述，新关系由一个名为group的字段键入</p>
</li>
<li>
<p>此组字段与每个输入的一个包相关联
<img src="http://i.imgur.com/sNtvMN6.png" height="120px" /></p>
</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              112/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-113">
          <div class="inner">
            
            <header><h1>COGROUP的示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/iaZyhuH.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              113/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-114">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 使用Pig的多数据集操作</p>
<ul>
<li>组合数据集的技术</li>
<li><span style="color:red;"><strong>在Pig中连接数据集</strong></span></li>
<li>设置操作</li>
<li>拆分数据集</li>
<li>结论</li>
<li>实践练习：使用Pig分析不同的数据集</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              114/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-115">
          <div class="inner">
            
            <header><h1>连接数据集概述</h1></header>
            
            
            <section><p># COGROUP运算符创建嵌套数据结构</p>
<p># Pig Latin JOIN运算符创建一个平面数据结构</p>
<ul>
<li>类似于关系数据库中的连接</li>
</ul>
<p># JOIN类似于执行COGROUP，然后是FLATTEN</p>
<ul>
<li>虽然他们处理空值不同</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              115/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-116">
          <div class="inner">
            
            <header><h1>关键字段</h1></header>
            
            
            <section><p># 像COGROUP一样，连接依赖于由每个关系共享的字段</p>
<pre><code>joined = JOIN stores BY store_id, salespeople BY store_id;
</code></pre>
<p># 连接也可以使用多个字段作为键</p>
<pre><code>joined = JOIN customers BY (name, phone_number),
              accounts BY (name, phone_number);
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              116/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-117">
          <div class="inner">
            
            <header><h1>内部连接</h1></header>
            
            
            <section><p># Pig Latin中的默认JOIN是内部连接</p>
<pre><code>joined = JOIN stores BY store_id, salespeople BY store_id;
</code></pre>
<p># 仅当在所有输入中找到键时，内部连接才输出记录</p>
<ul>
<li>在上面的示例中，具有至少一个销售人员的商店</li>
</ul>
<p># 您可以在单个语句中对多个关系执行内部连接</p>
<ul>
<li>但是您必须使用相同的键才能加入它们</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              117/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-118">
          <div class="inner">
            
            <header><h1>内部连接示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/JSxWGzW.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              118/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-119">
          <div class="inner">
            
            <header><h1>消除重复字段（1）</h1></header>
            
            
            <section><p># 与COGROUP一样，新关系仍包含重复字段
<img alt="" src="http://i.imgur.com/Vds5siT.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              119/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-120">
          <div class="inner">
            
            <header><h1>消除重复字段（2）</h1></header>
            
            
            <section><p># 我们可以使用FOREACH ... GENERATE来保留我们需要的字段</p>
<ul>
<li>然而，引用字段现在稍微复杂一点</li>
<li>我们必须完全限定名称不是唯一的任何字段
<img src="http://i.imgur.com/Gi5o8GM.png" width="853px" /></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              120/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-121">
          <div class="inner">
            
            <header><h1>外部连接</h1></header>
            
            
            <section><p># Pig Latin允许您指定字段名称后面的连接类型</p>
<ul>
<li>内部连接不指定连接类型
<img src="http://i.imgur.com/DObsBG5.png" width="830px" /></li>
</ul>
<p># 外部连接不需要在两个输入中都找到键</p>
<p># 外部连接需要Pig知道至少一个关系的模式</p>
<ul>
<li>哪个关系需要模式取决于连接类型</li>
<li>完全外部连接需要两个关系的模式</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              121/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-122">
          <div class="inner">
            
            <header><h1>左外连接示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/Quqz1mo.png" width="830px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              122/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-123">
          <div class="inner">
            
            <header><h1>右外连接示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/5Ww4wzM.png" width="830px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              123/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-124">
          <div class="inner">
            
            <header><h1>全外连接示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/ZeJIPYp.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              124/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-125">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 使用Pig的多数据集操作</p>
<ul>
<li>组合数据集的技术</li>
<li>在Pig中连接数据集</li>
<li><span style="color:red;"><strong>设置操作</strong></span></li>
<li>拆分数据集</li>
<li>结论</li>
<li>实践练习：使用Pig分析不同的数据集</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              125/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-126">
          <div class="inner">
            
            <header><h1>交叉数据集</h1></header>
            
            
            <section><p># JOIN在一个关系中查找与另一个关系中的记录匹配的记录</p>
<p># Pig的CROSS运算符创建两个关系的叉积</p>
<ul>
<li>组合两个表中的所有记录，而不考虑匹配</li>
<li>换句话说，所有可能的记录组合<pre><code>crossed = CROSS stores, salespeople;
</code></pre>
</li>
</ul>
<p># 小心：这可以产生大量的数据！</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              126/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-127">
          <div class="inner">
            
            <header><h1>交叉乘积示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/cRiBDGn.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              127/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-128">
          <div class="inner">
            
            <header><h1>连接数据集</h1></header>
            
            
            <section><p># 我们已经探索了用于组合数据集的几种技术</p>
<ul>
<li>他们有一个共同点：他们水平结合</li>
</ul>
<p># UNION运算符垂直组合记录</p>
<ul>
<li>它将来自输入关系的数据添加到新的单个关系中</li>
<li>Pig不需要这些输入具有相同的模式</li>
<li>它不会消除重复记录或保留顺序</li>
</ul>
<p># 这有助于将新数据合并到处理中</p>
<pre><code>both = UNION june_items, july_items;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              128/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-129">
          <div class="inner">
            
            <header><h1>UNION示例</h1></header>
            
            
            <section><p><img src="http://i.imgur.com/zBUPUcu.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              129/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-130">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 使用Pig的多数据集操作</p>
<ul>
<li>组合数据集的技术</li>
<li>在Pig中连接数据集</li>
<li>设置操作</li>
<li><span style="color:red;"><strong>拆分数据集</strong></span></li>
<li>结论</li>
<li>实践练习：使用Pig分析不同的数据集</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              130/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-131">
          <div class="inner">
            
            <header><h1>拆分数据集</h1></header>
            
            
            <section><p># 您已经学习了将数据集合并到单个关系中的几种方法</p>
<p># 有时您需要将数据集拆分为多个关系</p>
<ul>
<li>按日期范围的服务器日志</li>
<li>按地区列出的客户列表</li>
<li>按供应商列出的产品列表</li>
<li>等等</li>
</ul>
<p># Pig Latin支持使用SPLIT运算符</p>
<pre><code>SPLIT relation INTO relationA IF expression1,
      relationB IF expression2,
      relationC IF expression3...;
</code></pre>
<ul>
<li>表达式不必相互排斥</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              131/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-132">
          <div class="inner">
            
            <header><h1>拆分示例</h1></header>
            
            
            <section><p># 根据终身价值将客户分类进行奖励计划
<img alt="" src="http://i.imgur.com/neF7noW.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              132/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-133">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 使用Pig的多数据集操作</p>
<ul>
<li>组合数据集的技术</li>
<li>在Pig中连接数据集</li>
<li>设置操作</li>
<li>拆分数据集</li>
<li><span style="color:red;"><strong>结论</strong></span></li>
<li>实践练习：使用Pig分析不同的数据集</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              133/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-134">
          <div class="inner">
            
            <header><h1>基本要点</h1></header>
            
            
            <section><p># 您可以使用COGROUP将多个关系分组</p>
<ul>
<li>这将创建嵌套数据结构</li>
</ul>
<p># Pig支持常见的SQL连接类型</p>
<ul>
<li>内，左外，右外，和全外</li>
<li>使用连接数据时，可能需要完全限定字段名称</li>
</ul>
<p># Pig的CROSS运算符创建输入数据的所有可能组合</p>
<ul>
<li>这可以创建大量的数据 - 仔细使用它！</li>
</ul>
<p># 您可以使用UNION来连接数据集</p>
<p># 除了组合数据集，Pig还支持拼接它们</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              134/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-135">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># 使用Pig的多数据集操作</p>
<ul>
<li>组合数据集的技术</li>
<li>在Pig中连接数据集</li>
<li>设置操作</li>
<li>拆分数据集</li>
<li>结论</li>
<li><span style="color:red;"><strong>实践练习：使用Pig分析不同的数据集</strong></span></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              135/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-136">
          <div class="inner">
            
            <header><h1>实践练习：使用Pig分析不同的数据集</h1></header>
            
            
            <section><p># 在本练习中，您将使用Pig分析多个数据集</p>
<p># 有关说明，请参阅实践练习手册</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              136/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-137">
          <div class="inner">
            
            <header><h1>5.Pig故障排除和优化</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              137/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-138">
          <div class="inner">
            
            <header><h1>Pig故障排除和优化</h1></header>
            
            
            <section><p># 在本章中，您将学习</p>
<ul>
<li>如何控制Pig和Hadoop写入日志文件的信息</li>
<li>Hadoop的Web UI如何帮助您排除失败的作业</li>
<li>如何使用SAMPLE和ILLUSTRATE来测试和调试Pig作业</li>
<li>Pig如何从您的Pig Latin代码创建MapReduce作业</li>
<li>对您的Pig Latin代码几个简单的更改可以使它运行更快</li>
<li>哪些资源对排错Pig错误特别有用</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              138/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-139">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li><span style="color:red;"><strong>Pig故障排除</strong></span></li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行故障排除</li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li>了解执行计划</li>
<li>提高Pig作业表现的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              139/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-140">
          <div class="inner">
            
            <header><h1>故障排除概述</h1></header>
            
            
            <section><p># 我们现在已经介绍了如何使用Pig进行数据分析</p>
<ul>
<li>不幸的是，有时您的代码可能无法正常工作</li>
<li>重要的是要记住Pig和Hadoop是交织在一起的</li>
</ul>
<p># 这里我们将介绍一些隔离和解决问题的技术</p>
<ul>
<li>我们将从Pig命令的几个选项开始</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              140/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-141">
          <div class="inner">
            
            <header><h1>自我帮助</h1></header>
            
            
            <section><p># 我们将在本章讨论pig命令的一些选项</p>
<ul>
<li>您可以使用-h（帮助）选项查看所有这些</li>
<li>请记住，许多选项是高级的或很少使用</li>
</ul>
<p># 一个有用的选项是-c（check），它验证代码的语法</p>
<pre><code>$ pig -c myscript.pig
myscript.pig syntax OK
</code></pre>
<p># 如果使用参数或宏，-dryrun选项将非常有用</p>
<pre><code>$ pig -p INPUT=demodata -dryrun myscript.pig
</code></pre>
<ul>
<li>在当前目录中创建一个myscript.pig.substituted文件</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              141/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-142">
          <div class="inner">
            
            <header><h1>从其他人获得帮助</h1></header>
            
            
            <section><p># 有时你可能需要他人的帮助</p>
<ul>
<li>邮件列表或新闻组</li>
<li>论坛和公告板网站</li>
<li>支持服务</li>
</ul>
<p># 您可能需要提供您正在使用的Pig和Hadoop的版本</p>
<pre><code>$ pig -version
Apache Pig version 0.12.0-cdh5.2.0

$ hadoop version
Hadoop 2.5.0-cdh5.2.0
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              142/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-143">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li><span style="color:red;"><strong>记录</strong></span></li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行故障排除</li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li>了解执行计划</li>
<li>提高Pig作业表现的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              143/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-144">
          <div class="inner">
            
            <header><h1>自定义日志消息</h1></header>
            
            
            <section><p># 您可能希望更改记录的信息量</p>
<ul>
<li>Hadoop近期的一个变化在使用Pig时会产生很多警告</li>
</ul>
<p># Pig和Hadoop使用Log4J库，这是很容易定制的</p>
<p># 编辑/etc/pig/conf/log4j.properties文件包括：</p>
<pre><code>log4j.logger.org.apache.pig=ERROR
log4j.logger.org.apache.hadoop.conf.Configuration=ERROR
</code></pre>
<p># 编辑/etc/pig/conf/pig.properties文件以设置此属性：</p>
<pre><code>log4jconf=/etc/pig/conf/log4j.properties
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              144/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-145">
          <div class="inner">
            
            <header><h1>在每个作业的基础上定制日志消息</h1></header>
            
            
            <section><p># 你只想临时更改日志级别</p>
<ul>
<li>特别是当试图解决你的脚本的问题</li>
</ul>
<p># 您可以指定在调用Pig时使用的Log4J属性文件</p>
<ul>
<li>这将覆盖默认的Log4J配置</li>
</ul>
<p># 创建customlog.properties文件包括：</p>
<pre><code>log4j.logger.org.apache.pig=DEBUG
</code></pre>
<p># 通过Pig的-log4jconf参数指定此文件</p>
<pre><code>$ pig -log4jconf customlog.properties
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              145/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-146">
          <div class="inner">
            
            <header><h1>控制客户端日志文件</h1></header>
            
            
            <section><p># 当作业失败时，Pig可能会生成一个日志文件来解释为什么</p>
<ul>
<li>这些通常在当前目录中生成</li>
</ul>
<p># 要使用其他位置，请在启动Pig时使用-l（log）选项</p>
<pre><code>$ pig -l /tmp
</code></pre>
<p># 或通过编辑/etc/pig/conf/pig.properties永久设置</p>
<ul>
<li>
<p>使用log.file属性指定其他目录</p>
<pre><code>log.file=/tmp
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              146/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-147">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
</li>
<li>
<p>Pig故障排除</p>
</li>
<li>记录</li>
<li><span style="color:red;"><strong>使用Hadoop的Web UI</strong></span></li>
<li>可选演示：使用Web UI对失败的作业进行疑难解答</li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li>了解执行计划</li>
<li>提高你的Pig作业性能的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              147/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-148">
          <div class="inner">
            
            <header><h1>Hadoop Web UI</h1></header>
            
            
            <section><p># 每个Hadoop守护进程都有一个相应的Web应用程序</p>
<ul>
<li>这使我们可以轻松地通过浏览器查看集群和作业状态</li>
<li>在伪分布式模式下，主机名为localhost</li>
</ul>
<p><img alt="" src="http://i.imgur.com/2CLgVAR.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              148/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-149">
          <div class="inner">
            
            <header><h1>JobTracker Web UI(1)</h1></header>
            
            
            <section><p># JobTracker提供了最有用的Hadoop的Web UI</p>
<ul>
<li>它显示Hadoop集群的MapReduce状态信息</li>
</ul>
<p><img alt="" src="http://i.imgur.com/L4IrXWO.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              149/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-150">
          <div class="inner">
            
            <header><h1>JobTracker Web UI(2)</h1></header>
            
            
            <section><p># JobTracker Web UI还显示历史信息</p>
<ul>
<li>您可以点击其中一个链接查看特定工作的详细信息</li>
</ul>
<p><img alt="" src="http://i.imgur.com/NOyUmV5.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              150/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-151">
          <div class="inner">
            
            <header><h1>JobTracker Web UI(3)</h1></header>
            
            
            <section><p># 作业详细信息页面可以帮助您解决问题</p>
<p><img alt="" src="http://i.imgur.com/QgRZnpP.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              151/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-152">
          <div class="inner">
            
            <header><h1>命名您的工作</h1></header>
            
            
            <section><p># Hadoop集群通常是共享资源</p>
<ul>
<li>可能有几十个或数百个其他人使用集群</li>
<li>因此，有时很难在Web UI中找到您的作业</li>
</ul>
<p># 我们建议在脚本中使用名称来帮助识别您的作业</p>
<ul>
<li>在Grunt或您的脚本中设置job.name属性<pre><code>grunt&gt; set job.name 'Q2 2013 Sales Reporter';
</code></pre>
</li>
</ul>
<p><img alt="" src="http://i.imgur.com/hKeiK1U.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              152/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-153">
          <div class="inner">
            
            <header><h1>杀死一个作业</h1></header>
            
            
            <section><p># 处理大量数据的作业可能需要几个小时才能完成</p>
<ul>
<li>有时，您在提交作业后在代码中发现错误</li>
<li>而不是等待工作完成，你可以杀掉它</li>
</ul>
<p># 首先，在JobTracker Web UI的首页上找到作业ID</p>
<p><img alt="" src="http://i.imgur.com/oSaUoPI.png" /></p>
<p># 然后，在Pig中使用kill命令以及该作业ID</p>
<pre><code>grunt&gt; kill job_201303151454_0028
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              153/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-154">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li><span style="color:red;"><strong>可选演示：使用Web UI对失败的作业进行疑难解答</strong></span></li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li>了解执行计划</li>
<li>提高你的Pig作业性能的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              154/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-155">
          <div class="inner">
            
            <header><h1>可选演示：概述</h1></header>
            
            
            <section><p># 如果时间允许，您的教师现在将演示如何使用JobTracker Web UI来隔离我们的代码中导致作业失败的错误</p>
<p># 代码和指令已经在VM上</p>
<pre><code>$ cd ~/training_materials/analyst/webuidemo
$ cat README.txt
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              155/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-156">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行疑难解答</li>
<li><span style="color:red;"><strong>数据采样和调试</strong></span></li>
<li>性能概述</li>
<li>了解执行计划</li>
<li>提高你的Pig作业性能的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              156/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-157">
          <div class="inner">
            
            <header><h1>使用SAMPLE创建较小的数据集</h1></header>
            
            
            <section><p># 您的代码可能在生产中处理百万兆字节的数据</p>
<ul>
<li>然而，在开发期间以较小的量进行测试是方便的</li>
</ul>
<p># 使用SAMPLE从数据集中选择一组随机记录</p>
<p># 此示例从大数据中选择大约5％的记录</p>
<ul>
<li>
<p>将它们存储在一个名为mysample的新目录中</p>
<pre><code>everything = LOAD 'bigdata';
subset = SAMPLE everything 0.05;
STORE subset INTO 'mysample';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              157/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-158">
          <div class="inner">
            
            <header><h1>智能采样与ILLUSTRATE</h1></header>
            
            
            <section><p># 有时，随机样本可能缺少测试所需的数据</p>
</li>
<li>
<p>例如，对于JOIN操作，匹配两个数据集中的记录</p>
</li>
</ul>
<p># Pig的ILLUSTRATE关键字可以做更多的智能采样</p>
<ul>
<li>Pig将检查代码以确定需要什么数据</li>
<li>它选择了几个正确地练习代码的记录</li>
</ul>
<p># 您应该在使用ILLUSTRATE时指定模式</p>
<ul>
<li>当你不够时，Pig会产生记录</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              158/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-159">
          <div class="inner">
            
            <header><h1>使用ILLUSTRATE有助于您了解数据流</h1></header>
            
            
            <section><p># 像DUMP和DESCRIBE，ILLUSTRATE帮助调试</p>
<ul>
<li>这三个的语法都是相同的</li>
</ul>
<p><img alt="" src="http://i.imgur.com/sIUWmxx.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              159/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-160">
          <div class="inner">
            
            <header><h1>一般调试策略</h1></header>
            
            
            <section><p># 经常使用DUMP，DESCRIBE和ILLUSTRATE</p>
<p># 看一下数据的样本</p>
<ul>
<li>验证它是否与LOAD规范中的字段匹配</li>
<li>数据可能不是你认为的</li>
</ul>
<p># 跟踪问题的其他有用步骤</p>
<ul>
<li>在处理参数和宏后，使用-dryrun查看脚本</li>
<li>通过从本地文件传递一些数据来测试外部脚本（STREAM）</li>
<li>查看日志，特别是来自Web UI的可用任务日志</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              160/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-161">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行疑难解答</li>
<li>数据采样和调试</li>
<li><span style="color:red;"><strong>性能概述</strong></span></li>
<li>了解执行计划</li>
<li>提高你的Pig作业性能的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              161/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-162">
          <div class="inner">
            
            <header><h1>性能概述</h1></header>
            
            
            <section><p># 我们已经讨论了几种用于在Pig Latin代码中查找错误的技术</p>
<ul>
<li>一旦你的代码工作，你会经常想要它工作更快</li>
</ul>
<p># 性能调整是一个广泛和复杂的主题</p>
<ul>
<li>需要深入了解Pig，Hadoop，Java和Linux</li>
<li>通常是工程师和系统管理员的领域</li>
</ul>
<p># 这些主题大多超出了本课程的范围</p>
<ul>
<li>我们将在这里介绍一些基础知识，并提供几个性能改进提示</li>
<li>有关详细信息，请参阅《Programming Pig》（第7章和第8章）</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              162/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-163">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行疑难解答</li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li><span style="color:red;"><strong>了解执行计划</strong></span></li>
<li>提高你的Pig作业性能的一些提示</li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              163/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-164">
          <div class="inner">
            
            <header><h1>Pig Latin如何变成一个MapReduce作业</h1></header>
            
            
            <section><p># Pig Latin代码最终在Hadoop集群上作为MapReduce作业运行</p>
<p># 但是，Pig不会将您的代码转换为Java MapReduce</p>
<ul>
<li>很像关系数据库不会将SQL转换为C语言代码一样</li>
<li>像数据库一样，Pig解释Pig Latin来开发执行计划</li>
<li>Pig的执行引擎使用这些来向Hadoop提交MapReduce作业</li>
</ul>
<p># EXPLAIN关键字详述了Pig的三个执行计划</p>
<ul>
<li>逻辑</li>
<li>物理</li>
<li>MapReduce</li>
</ul>
<p># 查看示例作业将有助于我们理解EXPLAIN的输出</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              164/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-165">
          <div class="inner">
            
            <header><h1>我们的示例代码和数据的描述</h1></header>
            
            
            <section><p># 我们的目标是产生每个店铺的销售清单</p>
<p><img src="http://i.imgur.com/OQxIEpj.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              165/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-166">
          <div class="inner">
            
            <header><h1>使用EXPLAIN关键字</h1></header>
            
            
            <section><p># 使用EXPLAIN而不是DUMP将显示执行计划</p>
<p><img alt="" src="http://i.imgur.com/nrMlcXn.png" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              166/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-167">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行疑难解答</li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li>了解执行计划</li>
<li><span style="color:red;"><strong>提高你的Pig作业性能的一些提示</strong></span></li>
<li>结论</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              167/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-168">
          <div class="inner">
            
            <header><h1>Pig的运行时优化</h1></header>
            
            
            <section><p># Pig不一定像你写的那样运行你的语句</p>
<p># 它可能会删除操作的效率</p>
<pre><code>sales = LOAD 'sales' AS (store_id:chararray, price:int);
unused = FILTER sales BY price &gt; 789;
DUMP sales;
</code></pre>
<p># 它还可以重新整理操作以提高效率</p>
<pre><code>grouped = GROUP sales BY store_id;
totals = FOREACH grouped GENERATE group, SUM(sales.price);
joined = JOIN totals BY group, stores BY store_id;
only_a = FILTER joined BY store_id == 'A';
DUMP only_a;
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              168/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-169">
          <div class="inner">
            
            <header><h1>您可以在您的Pig Latin代码中进行优化</h1></header>
            
            
            <section><p># Pig的优化器可以提高性能</p>
<ul>
<li>但你知道你自己的代码和数据比它更好</li>
<li>您的代码中的一些小改动可以允许进行其他优化</li>
</ul>
<p># 在接下来的几张幻灯片中，我们将重写这个Pig代码的性能</p>
<pre><code>stores = LOAD 'stores' AS (store_id, name, postcode, phone);
sales = LOAD 'sales' AS (store_id, price);
joined = JOIN sales BY store_id, stores BY store_id;
DUMP joined;
groups = GROUP joined BY sales::store_id;
totals = FOREACH groups GENERATE
            FLATTEN(joined.stores::name) AS name,
            SUM(joined.sales::price) AS amount;
unique = DISTINCT totals;
region = FILTER unique BY name == 'Anchorage' OR name == 'Edmonton';
sorted = ORDER region BY amount DESC;
topone = LIMIT sorted 1;
STORE topone INTO 'topstore';
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              169/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-170">
          <div class="inner">
            
            <header><h1>你不是真的需要的就不要生产输出</h1></header>
            
            
            <section><p># 在这种情况下，我们忘记删除DUMP语句</p>
<ul>
<li>有时在从开发到生产时发生</li>
<li>如果你不看终端，它可能会被忽视</li>
</ul>
<p><img src="http://i.imgur.com/Oxg4bxf.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              170/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-171">
          <div class="inner">
            
            <header><h1>尽可能指定模式</h1></header>
            
            
            <section><p># 在加载数据时指定模式消除了Pig猜测的需要</p>
<ul>
<li>它可能选择一个比你需要的更大的类型（例如，long而不是int）</li>
</ul>
<p># 商店数据集中的邮政编码和电话字段也从未使用过</p>
<ul>
<li>在模式中删除它们可确保在连接中省略它们</li>
</ul>
<p><img src="http://i.imgur.com/Yi2fgpE.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              171/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-172">
          <div class="inner">
            
            <header><h1>尽可能早地过滤不需要的数据</h1></header>
            
            
            <section><p># 我们以前在我们的FILTER之前做了我们的JOIN</p>
<ul>
<li>这产生了大量数据而我们最终还是会丢弃掉</li>
<li>将FILTER操作向上移动使我们的脚本更有效率</li>
<li>注意：我们现在必须按商店ID而不是商店名称过滤</li>
</ul>
<p><img src="http://i.imgur.com/7p3AQFL.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              172/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-173">
          <div class="inner">
            
            <header><h1>思考调节并行化</h1></header>
            
            
            <section><p># Hadoop集群通过并行处理数据来扩展</p>
<ul>
<li>较新的Pig版本根据输入大小选择减少器的数量</li>
<li>但是，在脚本中显式设置值通常是有益的</li>
<li>您的系统管理员可以帮助您确定最佳值</li>
</ul>
<p><img src="http://i.imgur.com/AKbKjT6.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              173/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-174">
          <div class="inner">
            
            <header><h1>在Join中首先指定较小的数据集</h1></header>
            
            
            <section><p># 我们可以通过最后指定更大的数据集来优化连接</p>
<ul>
<li>Pig将“流动”更大的数据集，而不是将其读入内存</li>
<li>在我们的案例中，我们的销售记录远远超过商店数量</li>
<li>更改JOIN语句中的顺序可以提高性能</li>
</ul>
<p><img src="http://i.imgur.com/Sqi4QNo.png" width="853px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              174/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-175">
          <div class="inner">
            
            <header><h1>提高性能的更多提示</h1></header>
            
            
            <section><p># 主题：尽早消除不必要的数据</p>
<ul>
<li>使用FOREACH ... GENERATE只选择您需要的字段</li>
<li>当您只需要几个记录时，使用ORDER BY和LIMIT</li>
<li>当不需要重复记录时，请使用DISTINCT</li>
</ul>
<p># 在JOIN之前删除具有NULL键的记录可以提高性能</p>
<ul>
<li>这些记录将在最终输出中被消除</li>
<li>但是Pig不会在连接之前丢弃它们</li>
<li>在连接之前，使用FILTER删除带有空键的记录</li>
</ul>
<p><img src="http://i.imgur.com/l9F7uKX.png" height="180px" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              175/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-176">
          <div class="inner">
            
            <header><h1>章节主题</h1></header>
            
            
            <section><p># Pig故障排除和优化</p>
<ul>
<li>Pig故障排除</li>
<li>记录</li>
<li>使用Hadoop的Web UI</li>
<li>可选演示：使用Web UI对失败的作业进行疑难解答</li>
<li>数据采样和调试</li>
<li>性能概述</li>
<li>了解执行计划</li>
<li>提高你的Pig作业性能的一些提示</li>
<li><span style="color:red;"><strong>结论</strong></span></li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              176/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: pig.md -->
      <div class="slide-wrapper">
        <div class="slide slide-177">
          <div class="inner">
            
            <header><h1>基本要点</h1></header>
            
            
            <section><p># 您可以通过在处理期间消除不必要的数据来提高性能</p>
<p># Pig的错误消息并不总是清楚地标识问题的根源</p>
<ul>
<li>我们建议您使用小数据示例测试脚本</li>
<li>查看Web UI，尤其是日志消息，是会有帮助的</li>
</ul>
<p># 这些资源帮助您解决问题</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="pig.md">pig.md</a>
            </aside>
            
            <aside class="page_number">
              177/177
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source:  -->
      <div class="slide-wrapper">
        <div class="slide slide-">
          <div class="inner">
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="page_number">
              /177
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Cloudera Data Analyst Training-Pig 翻译</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">Apache Pig</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">1.Pig简介</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">Pig简介</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">章节主题</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">Apache Pig概述</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">Pig解析</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">从哪里获得Pig</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">章节主题</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">Pig的功能</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">章节主题</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">组织如何使用Pig</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">用例：Web日志会话化</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">用例：数据采样</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">用例：ETL处理</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">章节主题</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">交互式使用Pig</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">与HDFS交互</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">与UNIX交互</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">运行Pig脚本</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">MapReduce和本地模式</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">客户端日志文件</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">章节主题</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">基本要点</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">2.基本数据分析</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">基本数据分析</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">章节主题</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">Pig Latin概述</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
      <tr id="toc-row-29">
        <th><a href="#slide29">Pig Latin语法：关键词</a></th>
        <td><a href="#slide29">29</a></td>
      </tr>
      
      
      <tr id="toc-row-30">
        <th><a href="#slide30">Pig Latin语法：标识符(1)</a></th>
        <td><a href="#slide30">30</a></td>
      </tr>
      
      
      <tr id="toc-row-31">
        <th><a href="#slide31">Pig Latin语法：标识符(2)</a></th>
        <td><a href="#slide31">31</a></td>
      </tr>
      
      
      <tr id="toc-row-32">
        <th><a href="#slide32">Pig Latin语法：注释</a></th>
        <td><a href="#slide32">32</a></td>
      </tr>
      
      
      <tr id="toc-row-33">
        <th><a href="#slide33">Pig Latin对大小写敏感</a></th>
        <td><a href="#slide33">33</a></td>
      </tr>
      
      
      <tr id="toc-row-34">
        <th><a href="#slide34">Pig Latin中的常用运算符</a></th>
        <td><a href="#slide34">34</a></td>
      </tr>
      
      
      <tr id="toc-row-35">
        <th><a href="#slide35">章节主题</a></th>
        <td><a href="#slide35">35</a></td>
      </tr>
      
      
      <tr id="toc-row-36">
        <th><a href="#slide36">Pig中加载基本数据</a></th>
        <td><a href="#slide36">36</a></td>
      </tr>
      
      
      <tr id="toc-row-37">
        <th><a href="#slide37">数据源：文件和目录</a></th>
        <td><a href="#slide37">37</a></td>
      </tr>
      
      
      <tr id="toc-row-38">
        <th><a href="#slide38">在加载期间指定列名称</a></th>
        <td><a href="#slide38">38</a></td>
      </tr>
      
      
      <tr id="toc-row-39">
        <th><a href="#slide39">使用备用列分隔符</a></th>
        <td><a href="#slide39">39</a></td>
      </tr>
      
      
      <tr id="toc-row-40">
        <th><a href="#slide40">章节主题</a></th>
        <td><a href="#slide40">40</a></td>
      </tr>
      
      
      <tr id="toc-row-41">
        <th><a href="#slide41">Pig中的简单数据类型</a></th>
        <td><a href="#slide41">41</a></td>
      </tr>
      
      
      <tr id="toc-row-42">
        <th><a href="#slide42">简单数据类型列表</a></th>
        <td><a href="#slide42">42</a></td>
      </tr>
      
      
      <tr id="toc-row-43">
        <th><a href="#slide43">在Pig中指定数据类型</a></th>
        <td><a href="#slide43">43</a></td>
      </tr>
      
      
      <tr id="toc-row-44">
        <th><a href="#slide44">Pig如何处理无效数据</a></th>
        <td><a href="#slide44">44</a></td>
      </tr>
      
      
      <tr id="toc-row-45">
        <th><a href="#slide45">章节主题</a></th>
        <td><a href="#slide45">45</a></td>
      </tr>
      
      
      <tr id="toc-row-46">
        <th><a href="#slide46">Pig中的关键数据概念</a></th>
        <td><a href="#slide46">46</a></td>
      </tr>
      
      
      <tr id="toc-row-47">
        <th><a href="#slide47">Pig数据概念：Fields</a></th>
        <td><a href="#slide47">47</a></td>
      </tr>
      
      
      <tr id="toc-row-48">
        <th><a href="#slide48">Pig数据概念：Tuples</a></th>
        <td><a href="#slide48">48</a></td>
      </tr>
      
      
      <tr id="toc-row-49">
        <th><a href="#slide49">Pig数据概念：Bags</a></th>
        <td><a href="#slide49">49</a></td>
      </tr>
      
      
      <tr id="toc-row-50">
        <th><a href="#slide50">Pig数据概念：Relations</a></th>
        <td><a href="#slide50">50</a></td>
      </tr>
      
      
      <tr id="toc-row-51">
        <th><a href="#slide51">章节主题</a></th>
        <td><a href="#slide51">51</a></td>
      </tr>
      
      
      <tr id="toc-row-52">
        <th><a href="#slide52">Pig中的数据输出</a></th>
        <td><a href="#slide52">52</a></td>
      </tr>
      
      
      <tr id="toc-row-53">
        <th><a href="#slide53">使用Pig存储数据</a></th>
        <td><a href="#slide53">53</a></td>
      </tr>
      
      
      <tr id="toc-row-54">
        <th><a href="#slide54">章节主题</a></th>
        <td><a href="#slide54">54</a></td>
      </tr>
      
      
      <tr id="toc-row-55">
        <th><a href="#slide55">使用DESCRIBE查看模式</a></th>
        <td><a href="#slide55">55</a></td>
      </tr>
      
      
      <tr id="toc-row-56">
        <th><a href="#slide56">章节主题</a></th>
        <td><a href="#slide56">56</a></td>
      </tr>
      
      
      <tr id="toc-row-57">
        <th><a href="#slide57">Pig Latin中过滤</a></th>
        <td><a href="#slide57">57</a></td>
      </tr>
      
      
      <tr id="toc-row-58">
        <th><a href="#slide58">按多个条件过滤</a></th>
        <td><a href="#slide58">58</a></td>
      </tr>
      
      
      <tr id="toc-row-59">
        <th><a href="#slide59">Aside：在Pig Latin中String的比较</a></th>
        <td><a href="#slide59">59</a></td>
      </tr>
      
      
      <tr id="toc-row-60">
        <th><a href="#slide60">Pig Latin中的字段选择</a></th>
        <td><a href="#slide60">60</a></td>
      </tr>
      
      
      <tr id="toc-row-61">
        <th><a href="#slide61">在Pig Latin中生成新字段</a></th>
        <td><a href="#slide61">61</a></td>
      </tr>
      
      
      <tr id="toc-row-62">
        <th><a href="#slide62">消除重复</a></th>
        <td><a href="#slide62">62</a></td>
      </tr>
      
      
      <tr id="toc-row-63">
        <th><a href="#slide63">控制排序顺序</a></th>
        <td><a href="#slide63">63</a></td>
      </tr>
      
      
      <tr id="toc-row-64">
        <th><a href="#slide64">限制结果</a></th>
        <td><a href="#slide64">64</a></td>
      </tr>
      
      
      <tr id="toc-row-65">
        <th><a href="#slide65">章节主题</a></th>
        <td><a href="#slide65">65</a></td>
      </tr>
      
      
      <tr id="toc-row-66">
        <th><a href="#slide66">内置函数</a></th>
        <td><a href="#slide66">66</a></td>
      </tr>
      
      
      <tr id="toc-row-67">
        <th><a href="#slide67">章节主题</a></th>
        <td><a href="#slide67">67</a></td>
      </tr>
      
      
      <tr id="toc-row-68">
        <th><a href="#slide68">基本要点</a></th>
        <td><a href="#slide68">68</a></td>
      </tr>
      
      
      <tr id="toc-row-69">
        <th><a href="#slide69">章节主题</a></th>
        <td><a href="#slide69">69</a></td>
      </tr>
      
      
      <tr id="toc-row-70">
        <th><a href="#slide70">3.用Pig处理复杂数据</a></th>
        <td><a href="#slide70">70</a></td>
      </tr>
      
      
      <tr id="toc-row-71">
        <th><a href="#slide71">用Pig处理复杂数据</a></th>
        <td><a href="#slide71">71</a></td>
      </tr>
      
      
      <tr id="toc-row-72">
        <th><a href="#slide72">章节主题</a></th>
        <td><a href="#slide72">72</a></td>
      </tr>
      
      
      <tr id="toc-row-73">
        <th><a href="#slide73">存储格式</a></th>
        <td><a href="#slide73">73</a></td>
      </tr>
      
      
      <tr id="toc-row-74">
        <th><a href="#slide74">其他支持的格式</a></th>
        <td><a href="#slide74">74</a></td>
      </tr>
      
      
      <tr id="toc-row-75">
        <th><a href="#slide75">加载和存储函数</a></th>
        <td><a href="#slide75">75</a></td>
      </tr>
      
      
      <tr id="toc-row-76">
        <th><a href="#slide76">章节主题</a></th>
        <td><a href="#slide76">76</a></td>
      </tr>
      
      
      <tr id="toc-row-77">
        <th><a href="#slide77">Pig的复杂数据类型：Tuple和Bag</a></th>
        <td><a href="#slide77">77</a></td>
      </tr>
      
      
      <tr id="toc-row-78">
        <th><a href="#slide78">Pig的复杂数据类型：Map</a></th>
        <td><a href="#slide78">78</a></td>
      </tr>
      
      
      <tr id="toc-row-79">
        <th><a href="#slide79">在Pig中表示复杂类型</a></th>
        <td><a href="#slide79">79</a></td>
      </tr>
      
      
      <tr id="toc-row-80">
        <th><a href="#slide80">加载和使用复杂类型(1)</a></th>
        <td><a href="#slide80">80</a></td>
      </tr>
      
      
      <tr id="toc-row-81">
        <th><a href="#slide81">加载和使用复杂类型(2)</a></th>
        <td><a href="#slide81">81</a></td>
      </tr>
      
      
      <tr id="toc-row-82">
        <th><a href="#slide82">引用映射数据</a></th>
        <td><a href="#slide82">82</a></td>
      </tr>
      
      
      <tr id="toc-row-83">
        <th><a href="#slide83">章节主题</a></th>
        <td><a href="#slide83">83</a></td>
      </tr>
      
      
      <tr id="toc-row-84">
        <th><a href="#slide84">按字段对记录进行分组(1)</a></th>
        <td><a href="#slide84">84</a></td>
      </tr>
      
      
      <tr id="toc-row-85">
        <th><a href="#slide85">按字段对记录进行分组(2)</a></th>
        <td><a href="#slide85">85</a></td>
      </tr>
      
      
      <tr id="toc-row-86">
        <th><a href="#slide86">按字段对记录进行分组(3)</a></th>
        <td><a href="#slide86">86</a></td>
      </tr>
      
      
      <tr id="toc-row-87">
        <th><a href="#slide87">使用GROUP BY聚合数据</a></th>
        <td><a href="#slide87">87</a></td>
      </tr>
      
      
      <tr id="toc-row-88">
        <th><a href="#slide88">将所有内容分组到单个记录</a></th>
        <td><a href="#slide88">88</a></td>
      </tr>
      
      
      <tr id="toc-row-89">
        <th><a href="#slide89">使用GROUP ALL聚合数据</a></th>
        <td><a href="#slide89">89</a></td>
      </tr>
      
      
      <tr id="toc-row-90">
        <th><a href="#slide90">删除数据中的嵌套</a></th>
        <td><a href="#slide90">90</a></td>
      </tr>
      
      
      <tr id="toc-row-91">
        <th><a href="#slide91">FLATTEN的示例</a></th>
        <td><a href="#slide91">91</a></td>
      </tr>
      
      
      <tr id="toc-row-92">
        <th><a href="#slide92">章节主题</a></th>
        <td><a href="#slide92">92</a></td>
      </tr>
      
      
      <tr id="toc-row-93">
        <th><a href="#slide93">Pig的内置聚合函数</a></th>
        <td><a href="#slide93">93</a></td>
      </tr>
      
      
      <tr id="toc-row-94">
        <th><a href="#slide94">其他值得注意的内置函数</a></th>
        <td><a href="#slide94">94</a></td>
      </tr>
      
      
      <tr id="toc-row-95">
        <th><a href="#slide95">章节主题</a></th>
        <td><a href="#slide95">95</a></td>
      </tr>
      
      
      <tr id="toc-row-96">
        <th><a href="#slide96">记录迭代</a></th>
        <td><a href="#slide96">96</a></td>
      </tr>
      
      
      <tr id="toc-row-97">
        <th><a href="#slide97">嵌套FOREACH关键字</a></th>
        <td><a href="#slide97">97</a></td>
      </tr>
      
      
      <tr id="toc-row-98">
        <th><a href="#slide98">嵌套FOREACH示例(1)</a></th>
        <td><a href="#slide98">98</a></td>
      </tr>
      
      
      <tr id="toc-row-99">
        <th><a href="#slide99">嵌套FOREACH示例(2)</a></th>
        <td><a href="#slide99">99</a></td>
      </tr>
      
      
      <tr id="toc-row-100">
        <th><a href="#slide100">嵌套FOREACH示例(3)</a></th>
        <td><a href="#slide100">100</a></td>
      </tr>
      
      
      <tr id="toc-row-101">
        <th><a href="#slide101">嵌套FOREACH示例(4)</a></th>
        <td><a href="#slide101">101</a></td>
      </tr>
      
      
      <tr id="toc-row-102">
        <th><a href="#slide102">章节主题</a></th>
        <td><a href="#slide102">102</a></td>
      </tr>
      
      
      <tr id="toc-row-103">
        <th><a href="#slide103">基本要点</a></th>
        <td><a href="#slide103">103</a></td>
      </tr>
      
      
      <tr id="toc-row-104">
        <th><a href="#slide104">章节主题</a></th>
        <td><a href="#slide104">104</a></td>
      </tr>
      
      
      <tr id="toc-row-105">
        <th><a href="#slide105">实践练习：使用Pig分析广告系列数据</a></th>
        <td><a href="#slide105">105</a></td>
      </tr>
      
      
      <tr id="toc-row-106">
        <th><a href="#slide106">4.使用Pig的多数据集操作</a></th>
        <td><a href="#slide106">106</a></td>
      </tr>
      
      
      <tr id="toc-row-107">
        <th><a href="#slide107">使用Pig的多数据集操作</a></th>
        <td><a href="#slide107">107</a></td>
      </tr>
      
      
      <tr id="toc-row-108">
        <th><a href="#slide108">章节主题</a></th>
        <td><a href="#slide108">108</a></td>
      </tr>
      
      
      <tr id="toc-row-109">
        <th><a href="#slide109">组合数据集概述</a></th>
        <td><a href="#slide109">109</a></td>
      </tr>
      
      
      <tr id="toc-row-110">
        <th><a href="#slide110">示例数据集（1）</a></th>
        <td><a href="#slide110">110</a></td>
      </tr>
      
      
      <tr id="toc-row-111">
        <th><a href="#slide111">示例数据集（2）</a></th>
        <td><a href="#slide111">111</a></td>
      </tr>
      
      
      <tr id="toc-row-112">
        <th><a href="#slide112">分组多重关系</a></th>
        <td><a href="#slide112">112</a></td>
      </tr>
      
      
      <tr id="toc-row-113">
        <th><a href="#slide113">COGROUP的示例</a></th>
        <td><a href="#slide113">113</a></td>
      </tr>
      
      
      <tr id="toc-row-114">
        <th><a href="#slide114">章节主题</a></th>
        <td><a href="#slide114">114</a></td>
      </tr>
      
      
      <tr id="toc-row-115">
        <th><a href="#slide115">连接数据集概述</a></th>
        <td><a href="#slide115">115</a></td>
      </tr>
      
      
      <tr id="toc-row-116">
        <th><a href="#slide116">关键字段</a></th>
        <td><a href="#slide116">116</a></td>
      </tr>
      
      
      <tr id="toc-row-117">
        <th><a href="#slide117">内部连接</a></th>
        <td><a href="#slide117">117</a></td>
      </tr>
      
      
      <tr id="toc-row-118">
        <th><a href="#slide118">内部连接示例</a></th>
        <td><a href="#slide118">118</a></td>
      </tr>
      
      
      <tr id="toc-row-119">
        <th><a href="#slide119">消除重复字段（1）</a></th>
        <td><a href="#slide119">119</a></td>
      </tr>
      
      
      <tr id="toc-row-120">
        <th><a href="#slide120">消除重复字段（2）</a></th>
        <td><a href="#slide120">120</a></td>
      </tr>
      
      
      <tr id="toc-row-121">
        <th><a href="#slide121">外部连接</a></th>
        <td><a href="#slide121">121</a></td>
      </tr>
      
      
      <tr id="toc-row-122">
        <th><a href="#slide122">左外连接示例</a></th>
        <td><a href="#slide122">122</a></td>
      </tr>
      
      
      <tr id="toc-row-123">
        <th><a href="#slide123">右外连接示例</a></th>
        <td><a href="#slide123">123</a></td>
      </tr>
      
      
      <tr id="toc-row-124">
        <th><a href="#slide124">全外连接示例</a></th>
        <td><a href="#slide124">124</a></td>
      </tr>
      
      
      <tr id="toc-row-125">
        <th><a href="#slide125">章节主题</a></th>
        <td><a href="#slide125">125</a></td>
      </tr>
      
      
      <tr id="toc-row-126">
        <th><a href="#slide126">交叉数据集</a></th>
        <td><a href="#slide126">126</a></td>
      </tr>
      
      
      <tr id="toc-row-127">
        <th><a href="#slide127">交叉乘积示例</a></th>
        <td><a href="#slide127">127</a></td>
      </tr>
      
      
      <tr id="toc-row-128">
        <th><a href="#slide128">连接数据集</a></th>
        <td><a href="#slide128">128</a></td>
      </tr>
      
      
      <tr id="toc-row-129">
        <th><a href="#slide129">UNION示例</a></th>
        <td><a href="#slide129">129</a></td>
      </tr>
      
      
      <tr id="toc-row-130">
        <th><a href="#slide130">章节主题</a></th>
        <td><a href="#slide130">130</a></td>
      </tr>
      
      
      <tr id="toc-row-131">
        <th><a href="#slide131">拆分数据集</a></th>
        <td><a href="#slide131">131</a></td>
      </tr>
      
      
      <tr id="toc-row-132">
        <th><a href="#slide132">拆分示例</a></th>
        <td><a href="#slide132">132</a></td>
      </tr>
      
      
      <tr id="toc-row-133">
        <th><a href="#slide133">章节主题</a></th>
        <td><a href="#slide133">133</a></td>
      </tr>
      
      
      <tr id="toc-row-134">
        <th><a href="#slide134">基本要点</a></th>
        <td><a href="#slide134">134</a></td>
      </tr>
      
      
      <tr id="toc-row-135">
        <th><a href="#slide135">章节主题</a></th>
        <td><a href="#slide135">135</a></td>
      </tr>
      
      
      <tr id="toc-row-136">
        <th><a href="#slide136">实践练习：使用Pig分析不同的数据集</a></th>
        <td><a href="#slide136">136</a></td>
      </tr>
      
      
      <tr id="toc-row-137">
        <th><a href="#slide137">5.Pig故障排除和优化</a></th>
        <td><a href="#slide137">137</a></td>
      </tr>
      
      
      <tr id="toc-row-138">
        <th><a href="#slide138">Pig故障排除和优化</a></th>
        <td><a href="#slide138">138</a></td>
      </tr>
      
      
      <tr id="toc-row-139">
        <th><a href="#slide139">章节主题</a></th>
        <td><a href="#slide139">139</a></td>
      </tr>
      
      
      <tr id="toc-row-140">
        <th><a href="#slide140">故障排除概述</a></th>
        <td><a href="#slide140">140</a></td>
      </tr>
      
      
      <tr id="toc-row-141">
        <th><a href="#slide141">自我帮助</a></th>
        <td><a href="#slide141">141</a></td>
      </tr>
      
      
      <tr id="toc-row-142">
        <th><a href="#slide142">从其他人获得帮助</a></th>
        <td><a href="#slide142">142</a></td>
      </tr>
      
      
      <tr id="toc-row-143">
        <th><a href="#slide143">章节主题</a></th>
        <td><a href="#slide143">143</a></td>
      </tr>
      
      
      <tr id="toc-row-144">
        <th><a href="#slide144">自定义日志消息</a></th>
        <td><a href="#slide144">144</a></td>
      </tr>
      
      
      <tr id="toc-row-145">
        <th><a href="#slide145">在每个作业的基础上定制日志消息</a></th>
        <td><a href="#slide145">145</a></td>
      </tr>
      
      
      <tr id="toc-row-146">
        <th><a href="#slide146">控制客户端日志文件</a></th>
        <td><a href="#slide146">146</a></td>
      </tr>
      
      
      <tr id="toc-row-147">
        <th><a href="#slide147">章节主题</a></th>
        <td><a href="#slide147">147</a></td>
      </tr>
      
      
      <tr id="toc-row-148">
        <th><a href="#slide148">Hadoop Web UI</a></th>
        <td><a href="#slide148">148</a></td>
      </tr>
      
      
      <tr id="toc-row-149">
        <th><a href="#slide149">JobTracker Web UI(1)</a></th>
        <td><a href="#slide149">149</a></td>
      </tr>
      
      
      <tr id="toc-row-150">
        <th><a href="#slide150">JobTracker Web UI(2)</a></th>
        <td><a href="#slide150">150</a></td>
      </tr>
      
      
      <tr id="toc-row-151">
        <th><a href="#slide151">JobTracker Web UI(3)</a></th>
        <td><a href="#slide151">151</a></td>
      </tr>
      
      
      <tr id="toc-row-152">
        <th><a href="#slide152">命名您的工作</a></th>
        <td><a href="#slide152">152</a></td>
      </tr>
      
      
      <tr id="toc-row-153">
        <th><a href="#slide153">杀死一个作业</a></th>
        <td><a href="#slide153">153</a></td>
      </tr>
      
      
      <tr id="toc-row-154">
        <th><a href="#slide154">章节主题</a></th>
        <td><a href="#slide154">154</a></td>
      </tr>
      
      
      <tr id="toc-row-155">
        <th><a href="#slide155">可选演示：概述</a></th>
        <td><a href="#slide155">155</a></td>
      </tr>
      
      
      <tr id="toc-row-156">
        <th><a href="#slide156">章节主题</a></th>
        <td><a href="#slide156">156</a></td>
      </tr>
      
      
      <tr id="toc-row-157">
        <th><a href="#slide157">使用SAMPLE创建较小的数据集</a></th>
        <td><a href="#slide157">157</a></td>
      </tr>
      
      
      <tr id="toc-row-158">
        <th><a href="#slide158">智能采样与ILLUSTRATE</a></th>
        <td><a href="#slide158">158</a></td>
      </tr>
      
      
      <tr id="toc-row-159">
        <th><a href="#slide159">使用ILLUSTRATE有助于您了解数据流</a></th>
        <td><a href="#slide159">159</a></td>
      </tr>
      
      
      <tr id="toc-row-160">
        <th><a href="#slide160">一般调试策略</a></th>
        <td><a href="#slide160">160</a></td>
      </tr>
      
      
      <tr id="toc-row-161">
        <th><a href="#slide161">章节主题</a></th>
        <td><a href="#slide161">161</a></td>
      </tr>
      
      
      <tr id="toc-row-162">
        <th><a href="#slide162">性能概述</a></th>
        <td><a href="#slide162">162</a></td>
      </tr>
      
      
      <tr id="toc-row-163">
        <th><a href="#slide163">章节主题</a></th>
        <td><a href="#slide163">163</a></td>
      </tr>
      
      
      <tr id="toc-row-164">
        <th><a href="#slide164">Pig Latin如何变成一个MapReduce作业</a></th>
        <td><a href="#slide164">164</a></td>
      </tr>
      
      
      <tr id="toc-row-165">
        <th><a href="#slide165">我们的示例代码和数据的描述</a></th>
        <td><a href="#slide165">165</a></td>
      </tr>
      
      
      <tr id="toc-row-166">
        <th><a href="#slide166">使用EXPLAIN关键字</a></th>
        <td><a href="#slide166">166</a></td>
      </tr>
      
      
      <tr id="toc-row-167">
        <th><a href="#slide167">章节主题</a></th>
        <td><a href="#slide167">167</a></td>
      </tr>
      
      
      <tr id="toc-row-168">
        <th><a href="#slide168">Pig的运行时优化</a></th>
        <td><a href="#slide168">168</a></td>
      </tr>
      
      
      <tr id="toc-row-169">
        <th><a href="#slide169">您可以在您的Pig Latin代码中进行优化</a></th>
        <td><a href="#slide169">169</a></td>
      </tr>
      
      
      <tr id="toc-row-170">
        <th><a href="#slide170">你不是真的需要的就不要生产输出</a></th>
        <td><a href="#slide170">170</a></td>
      </tr>
      
      
      <tr id="toc-row-171">
        <th><a href="#slide171">尽可能指定模式</a></th>
        <td><a href="#slide171">171</a></td>
      </tr>
      
      
      <tr id="toc-row-172">
        <th><a href="#slide172">尽可能早地过滤不需要的数据</a></th>
        <td><a href="#slide172">172</a></td>
      </tr>
      
      
      <tr id="toc-row-173">
        <th><a href="#slide173">思考调节并行化</a></th>
        <td><a href="#slide173">173</a></td>
      </tr>
      
      
      <tr id="toc-row-174">
        <th><a href="#slide174">在Join中首先指定较小的数据集</a></th>
        <td><a href="#slide174">174</a></td>
      </tr>
      
      
      <tr id="toc-row-175">
        <th><a href="#slide175">提高性能的更多提示</a></th>
        <td><a href="#slide175">175</a></td>
      </tr>
      
      
      <tr id="toc-row-176">
        <th><a href="#slide176">章节主题</a></th>
        <td><a href="#slide176">176</a></td>
      </tr>
      
      
      <tr id="toc-row-177">
        <th><a href="#slide177">基本要点</a></th>
        <td><a href="#slide177">177</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>